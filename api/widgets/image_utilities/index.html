
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Napari widgets to process microscopy images">
      
      
      
        <link rel="canonical" href="https://TimMonko.github.io/napari-ndev/api/widgets/image_utilities/">
      
      
        <link rel="prev" href="../../../examples/measure/measure_widget/">
      
      
        <link rel="next" href="../workflow_widget/">
      
      
      <link rel="icon" href="../../../resources/images/nDev-icon.svg">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.12">
    
    
      
        <title>Image utilities - napari-ndev</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.2afb09e1.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#napari_ndev.widgets._utilities_container" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="napari-ndev" class="md-header__button md-logo" aria-label="napari-ndev" data-md-component="logo">
      
  <img src="../../../resources/images/nDev-icon.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            napari-ndev
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Image utilities
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="light-green"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/timmonko/napari-ndev" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    timmonko/napari-ndev
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="napari-ndev" class="md-nav__button md-logo" aria-label="napari-ndev" data-md-component="logo">
      
  <img src="../../../resources/images/nDev-icon.svg" alt="logo">

    </a>
    napari-ndev
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/timmonko/napari-ndev" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    timmonko/napari-ndev
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installation
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../beginner_setup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Beginner Setup
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../widget_further_info/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Further Widget Info
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../BINA_poster/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Poster
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    I2K Workshop
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            I2K Workshop
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorial/00_setup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    1) Tutorial Setup
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorial/01_example_pipeline/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2) Example Pipeline
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorial/02_easy_ML/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    3) Easy Machine Learning
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorial/03_build_pipeline/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    4) Build Your Own Pipeline
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Examples
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/utilities/image_utilities/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Image Utilities
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_2" >
        
          
          <label class="md-nav__link" for="__nav_7_2" id="__nav_7_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Workflow
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_2">
            <span class="md-nav__icon md-icon"></span>
            Workflow
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/workflow/workflow_napari-assistant/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Generating workflows with napari
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/workflow/workflow_widget/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Workflow Widget
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/workflow/workflow_scripting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Scripting a Workflow
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/measure/measure_widget/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Measure Widget
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" checked>
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    API
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_1" checked>
        
          
          <label class="md-nav__link" for="__nav_8_1" id="__nav_8_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Widgets
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_8_1">
            <span class="md-nav__icon md-icon"></span>
            Widgets
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Image utilities
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Image utilities
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#napari_ndev.widgets._utilities_container.UtilitiesContainer" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;UtilitiesContainer
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" UtilitiesContainer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#napari_ndev.widgets._utilities_container.UtilitiesContainer(viewer)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;viewer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#napari_ndev.widgets._utilities_container.UtilitiesContainer.p_sizes" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;p_sizes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#napari_ndev.widgets._utilities_container.UtilitiesContainer.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;__init__
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" __init__">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#napari_ndev.widgets._utilities_container.UtilitiesContainer.__init__(viewer)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;viewer
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#napari_ndev.widgets._utilities_container.UtilitiesContainer.append_scene_to_name" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;append_scene_to_name
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#napari_ndev.widgets._utilities_container.UtilitiesContainer.batch_concatenate_files" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;batch_concatenate_files
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#napari_ndev.widgets._utilities_container.UtilitiesContainer.canvas_export_figure" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;canvas_export_figure
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#napari_ndev.widgets._utilities_container.UtilitiesContainer.canvas_screenshot" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;canvas_screenshot
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#napari_ndev.widgets._utilities_container.UtilitiesContainer.concatenate_files" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;concatenate_files
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" concatenate_files">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#napari_ndev.widgets._utilities_container.UtilitiesContainer.concatenate_files(files)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;files
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#napari_ndev.widgets._utilities_container.UtilitiesContainer.concatenate_layers" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;concatenate_layers
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" concatenate_layers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#napari_ndev.widgets._utilities_container.UtilitiesContainer.concatenate_layers(layers)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;layers
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#napari_ndev.widgets._utilities_container.UtilitiesContainer.open_images" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;open_images
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#napari_ndev.widgets._utilities_container.UtilitiesContainer.rescale_by" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;rescale_by
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#napari_ndev.widgets._utilities_container.UtilitiesContainer.save_files_as_ome_tiff" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;save_files_as_ome_tiff
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#napari_ndev.widgets._utilities_container.UtilitiesContainer.save_layers_as_ome_tiff" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;save_layers_as_ome_tiff
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#napari_ndev.widgets._utilities_container.UtilitiesContainer.save_scenes_ome_tiff" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;save_scenes_ome_tiff
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#napari_ndev.widgets._utilities_container.UtilitiesContainer.update_metadata_from_layer" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;update_metadata_from_layer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#napari_ndev.widgets._utilities_container.UtilitiesContainer.update_metadata_on_file_select" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;update_metadata_on_file_select
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#napari_ndev.widgets._utilities_container.UtilitiesContainer.update_save_directory" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;update_save_directory
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workflow_widget/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Workflow widget
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../apoc_widget/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Apoc widget
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../custom_apoc_feature_set/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Custom apoc feature set
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../measure_widget/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Measure widget
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../napari_reader/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Napari reader
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../image_overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Image Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../plate_mapper/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PlateMapper
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../measure/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Measure
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../morphology/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Morphology
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../helpers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Helpers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../nimage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    nImage
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#napari_ndev.widgets._utilities_container.UtilitiesContainer" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;UtilitiesContainer
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" UtilitiesContainer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#napari_ndev.widgets._utilities_container.UtilitiesContainer(viewer)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;viewer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#napari_ndev.widgets._utilities_container.UtilitiesContainer.p_sizes" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;p_sizes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#napari_ndev.widgets._utilities_container.UtilitiesContainer.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;__init__
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" __init__">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#napari_ndev.widgets._utilities_container.UtilitiesContainer.__init__(viewer)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;viewer
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#napari_ndev.widgets._utilities_container.UtilitiesContainer.append_scene_to_name" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;append_scene_to_name
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#napari_ndev.widgets._utilities_container.UtilitiesContainer.batch_concatenate_files" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;batch_concatenate_files
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#napari_ndev.widgets._utilities_container.UtilitiesContainer.canvas_export_figure" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;canvas_export_figure
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#napari_ndev.widgets._utilities_container.UtilitiesContainer.canvas_screenshot" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;canvas_screenshot
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#napari_ndev.widgets._utilities_container.UtilitiesContainer.concatenate_files" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;concatenate_files
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" concatenate_files">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#napari_ndev.widgets._utilities_container.UtilitiesContainer.concatenate_files(files)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;files
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#napari_ndev.widgets._utilities_container.UtilitiesContainer.concatenate_layers" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;concatenate_layers
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" concatenate_layers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#napari_ndev.widgets._utilities_container.UtilitiesContainer.concatenate_layers(layers)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;layers
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#napari_ndev.widgets._utilities_container.UtilitiesContainer.open_images" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;open_images
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#napari_ndev.widgets._utilities_container.UtilitiesContainer.rescale_by" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;rescale_by
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#napari_ndev.widgets._utilities_container.UtilitiesContainer.save_files_as_ome_tiff" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;save_files_as_ome_tiff
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#napari_ndev.widgets._utilities_container.UtilitiesContainer.save_layers_as_ome_tiff" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;save_layers_as_ome_tiff
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#napari_ndev.widgets._utilities_container.UtilitiesContainer.save_scenes_ome_tiff" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;save_scenes_ome_tiff
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#napari_ndev.widgets._utilities_container.UtilitiesContainer.update_metadata_from_layer" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;update_metadata_from_layer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#napari_ndev.widgets._utilities_container.UtilitiesContainer.update_metadata_on_file_select" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;update_metadata_on_file_select
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#napari_ndev.widgets._utilities_container.UtilitiesContainer.update_save_directory" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;update_save_directory
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<div class="doc doc-object doc-module">



<h1 id="napari_ndev.widgets._utilities_container" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">napari_ndev.widgets._utilities_container</span>


<a href="#napari_ndev.widgets._utilities_container" class="headerlink" title="Permanent link">#</a></h1>

    <div class="doc doc-contents first">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="napari_ndev.widgets._utilities_container.UtilitiesContainer" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">UtilitiesContainer</span>


<a href="#napari_ndev.widgets._utilities_container.UtilitiesContainer" class="headerlink" title="Permanent link">#</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="magicclass.widgets.ScrollableContainer">ScrollableContainer</span></code></p>


        <p>A widget to work with images and labels in the napari viewer.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<h3 id="napari_ndev.widgets._utilities_container.UtilitiesContainer(viewer)" class="doc doc-heading doc-heading-parameter">              <b><code>viewer</code></b>
<a href="#napari_ndev.widgets._utilities_container.UtilitiesContainer(viewer)" class="headerlink" title="Permanent link">#</a></h3>              (<code><a class="autorefs autorefs-external" title="napari.viewer.Viewer" href="https://napari.org/stable/api/napari.Viewer.html#napari.Viewer">Viewer</a></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>The napari viewer instance.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Attributes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><span title="napari_ndev.widgets._utilities_container.UtilitiesContainer._viewer">_viewer</span></code></b>
              (<code><a class="autorefs autorefs-external" title="napari.viewer.Viewer" href="https://napari.org/stable/api/napari.Viewer.html#napari.Viewer">Viewer</a></code>)
          –
          <div class="doc-md-description">
            <p>The napari viewer instance.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="napari_ndev.widgets._utilities_container.UtilitiesContainer._image_save_dims">_image_save_dims</span></code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a> or None</code>)
          –
          <div class="doc-md-description">
            <p>The dimension order for saving images.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="napari_ndev.widgets._utilities_container.UtilitiesContainer._label_save_dims">_label_save_dims</span></code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a> or None</code>)
          –
          <div class="doc-md-description">
            <p>The dimension order for saving labels.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="napari_ndev.widgets._utilities_container.UtilitiesContainer._p_sizes">_p_sizes</span></code></b>
              (<code><span title="PhysicalPixelSizes">PhysicalPixelSizes</span></code>)
          –
          <div class="doc-md-description">
            <p>The physical pixel sizes for the image.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="napari_ndev.widgets._utilities_container.UtilitiesContainer._files">_files</span></code></b>
              (<code><span title="magicgui.widgets.FileEdit">FileEdit</span></code>)
          –
          <div class="doc-md-description">
            <p>Widget for selecting file(s).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="napari_ndev.widgets._utilities_container.UtilitiesContainer._open_image_button">_open_image_button</span></code></b>
              (<code><span title="magicgui.widgets.PushButton">PushButton</span></code>)
          –
          <div class="doc-md-description">
            <p>Button for opening images.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="napari_ndev.widgets._utilities_container.UtilitiesContainer._save_directory">_save_directory</span></code></b>
              (<code><span title="magicgui.widgets.FileEdit">FileEdit</span></code>)
          –
          <div class="doc-md-description">
            <p>Widget for selecting the save directory.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="napari_ndev.widgets._utilities_container.UtilitiesContainer._save_name">_save_name</span></code></b>
              (<code><span title="magicgui.widgets.LineEdit">LineEdit</span></code>)
          –
          <div class="doc-md-description">
            <p>Widget for entering the file save name.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="napari_ndev.widgets._utilities_container.UtilitiesContainer._metadata_from_selected_layer">_metadata_from_selected_layer</span></code></b>
              (<code><span title="magicgui.widgets.PushButton">PushButton</span></code>)
          –
          <div class="doc-md-description">
            <p>Button for updating metadata from the selected layer.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="napari_ndev.widgets._utilities_container.UtilitiesContainer._dim_order">_dim_order</span></code></b>
              (<code><span title="magicgui.widgets.LineEdit">LineEdit</span></code>)
          –
          <div class="doc-md-description">
            <p>Widget for entering the dimension order.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="napari_ndev.widgets._utilities_container.UtilitiesContainer._channel_names">_channel_names</span></code></b>
              (<code><span title="magicgui.widgets.LineEdit">LineEdit</span></code>)
          –
          <div class="doc-md-description">
            <p>Widget for entering the channel names.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="napari_ndev.widgets._utilities_container.UtilitiesContainer._physical_pixel_sizes_z">_physical_pixel_sizes_z</span></code></b>
              (<code><span title="FloatSpinBox">FloatSpinBox</span></code>)
          –
          <div class="doc-md-description">
            <p>Widget for entering the Z pixel size in micrometers.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="napari_ndev.widgets._utilities_container.UtilitiesContainer._physical_pixel_sizes_y">_physical_pixel_sizes_y</span></code></b>
              (<code><span title="FloatSpinBox">FloatSpinBox</span></code>)
          –
          <div class="doc-md-description">
            <p>Widget for entering the Y pixel size in micrometers.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="napari_ndev.widgets._utilities_container.UtilitiesContainer._physical_pixel_sizes_x">_physical_pixel_sizes_x</span></code></b>
              (<code><span title="FloatSpinBox">FloatSpinBox</span></code>)
          –
          <div class="doc-md-description">
            <p>Widget for entering the X pixel size in micrometers.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="napari_ndev.widgets._utilities_container.UtilitiesContainer._image_layer">_image_layer</span></code></b>
              (<code><span title="Select">Select</span></code>)
          –
          <div class="doc-md-description">
            <p>Widget for selecting the image layer.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="napari_ndev.widgets._utilities_container.UtilitiesContainer._concatenate_image_files">_concatenate_image_files</span></code></b>
              (<code><span title="magicgui.widgets.CheckBox">CheckBox</span></code>)
          –
          <div class="doc-md-description">
            <p>Checkbox for concatenating image files.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="napari_ndev.widgets._utilities_container.UtilitiesContainer._concatenate_image_layers">_concatenate_image_layers</span></code></b>
              (<code><span title="magicgui.widgets.CheckBox">CheckBox</span></code>)
          –
          <div class="doc-md-description">
            <p>Checkbox for concatenating image layers.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="napari_ndev.widgets._utilities_container.UtilitiesContainer._save_image_button">_save_image_button</span></code></b>
              (<code><span title="magicgui.widgets.PushButton">PushButton</span></code>)
          –
          <div class="doc-md-description">
            <p>Button for saving images.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="napari_ndev.widgets._utilities_container.UtilitiesContainer._labels_layer">_labels_layer</span></code></b>
              (<code><span title="Widget">Widget</span></code>)
          –
          <div class="doc-md-description">
            <p>Widget for working with labels layer.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="napari_ndev.widgets._utilities_container.UtilitiesContainer._save_labels_button">_save_labels_button</span></code></b>
              (<code><span title="magicgui.widgets.PushButton">PushButton</span></code>)
          –
          <div class="doc-md-description">
            <p>Button for saving labels.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="napari_ndev.widgets._utilities_container.UtilitiesContainer._shapes_layer">_shapes_layer</span></code></b>
              (<code><span title="Widget">Widget</span></code>)
          –
          <div class="doc-md-description">
            <p>Widget for working with shapes layer.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="napari_ndev.widgets._utilities_container.UtilitiesContainer._save_shapes_button">_save_shapes_button</span></code></b>
              (<code><span title="magicgui.widgets.PushButton">PushButton</span></code>)
          –
          <div class="doc-md-description">
            <p>Button for saving shapes as labels.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="napari_ndev.widgets._utilities_container.UtilitiesContainer._results">_results</span></code></b>
              (<code><span title="magicgui.widgets.TextEdit">TextEdit</span></code>)
          –
          <div class="doc-md-description">
            <p>Widget for displaying information.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Methods:</span></p>
    <ul>
          <li class="doc-section-item field-body">
            <b><code><span title="napari_ndev.widgets._utilities_container.UtilitiesContainer._update_metadata">_update_metadata</span></code></b>
            –
            <div class="doc-md-description">
              <p>Update the metadata based on the given image.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><span title="napari_ndev.widgets._utilities_container.UtilitiesContainer.update_metadata_from_file">update_metadata_from_file</span></code></b>
            –
            <div class="doc-md-description">
              <p>Update the metadata from the selected file.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            update_metadata_from_layer (napari_ndev.widgets._utilities_container.UtilitiesContainer.update_metadata_from_layer)" href="#napari_ndev.widgets._utilities_container.UtilitiesContainer.update_metadata_from_layer">update_metadata_from_layer</a></code></b>
            –
            <div class="doc-md-description">
              <p>Update the metadata from the selected layer.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            open_images (napari_ndev.widgets._utilities_container.UtilitiesContainer.open_images)" href="#napari_ndev.widgets._utilities_container.UtilitiesContainer.open_images">open_images</a></code></b>
            –
            <div class="doc-md-description">
              <p>Open the selected images in the napari viewer.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><span title="napari_ndev.widgets._utilities_container.UtilitiesContainer.concatenate_images">concatenate_images</span></code></b>
            –
            <div class="doc-md-description">
              <p>Concatenate the image data based on the selected options.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            p_sizes


  
      property
   (napari_ndev.widgets._utilities_container.UtilitiesContainer.p_sizes)" href="#napari_ndev.widgets._utilities_container.UtilitiesContainer.p_sizes">p_sizes</a></code></b>
            –
            <div class="doc-md-description">
              <p>Get the physical pixel sizes.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><span title="napari_ndev.widgets._utilities_container.UtilitiesContainer._get_save_loc">_get_save_loc</span></code></b>
            –
            <div class="doc-md-description">
              <p>Get the save location based on the parent directory.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><span title="napari_ndev.widgets._utilities_container.UtilitiesContainer._common_save_logic">_common_save_logic</span></code></b>
            –
            <div class="doc-md-description">
              <p>Common logic for saving data as OME-TIFF.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><span title="napari_ndev.widgets._utilities_container.UtilitiesContainer.save_ome_tiff">save_ome_tiff</span></code></b>
            –
            <div class="doc-md-description">
              <p>Save the concatenated image data as OME-TIFF.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><span title="napari_ndev.widgets._utilities_container.UtilitiesContainer.save_labels">save_labels</span></code></b>
            –
            <div class="doc-md-description">
              <p>Save the labels data.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><span title="napari_ndev.widgets._utilities_container.UtilitiesContainer.save_shapes_as_labels">save_shapes_as_labels</span></code></b>
            –
            <div class="doc-md-description">
              <p>Save the shapes data as labels.</p>
            </div>
          </li>
    </ul>







              <details class="quote">
                <summary>Source code in <code>src/napari_ndev/widgets/_utilities_container.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  39</span>
<span class="normal">  40</span>
<span class="normal">  41</span>
<span class="normal">  42</span>
<span class="normal">  43</span>
<span class="normal">  44</span>
<span class="normal">  45</span>
<span class="normal">  46</span>
<span class="normal">  47</span>
<span class="normal">  48</span>
<span class="normal">  49</span>
<span class="normal">  50</span>
<span class="normal">  51</span>
<span class="normal">  52</span>
<span class="normal">  53</span>
<span class="normal">  54</span>
<span class="normal">  55</span>
<span class="normal">  56</span>
<span class="normal">  57</span>
<span class="normal">  58</span>
<span class="normal">  59</span>
<span class="normal">  60</span>
<span class="normal">  61</span>
<span class="normal">  62</span>
<span class="normal">  63</span>
<span class="normal">  64</span>
<span class="normal">  65</span>
<span class="normal">  66</span>
<span class="normal">  67</span>
<span class="normal">  68</span>
<span class="normal">  69</span>
<span class="normal">  70</span>
<span class="normal">  71</span>
<span class="normal">  72</span>
<span class="normal">  73</span>
<span class="normal">  74</span>
<span class="normal">  75</span>
<span class="normal">  76</span>
<span class="normal">  77</span>
<span class="normal">  78</span>
<span class="normal">  79</span>
<span class="normal">  80</span>
<span class="normal">  81</span>
<span class="normal">  82</span>
<span class="normal">  83</span>
<span class="normal">  84</span>
<span class="normal">  85</span>
<span class="normal">  86</span>
<span class="normal">  87</span>
<span class="normal">  88</span>
<span class="normal">  89</span>
<span class="normal">  90</span>
<span class="normal">  91</span>
<span class="normal">  92</span>
<span class="normal">  93</span>
<span class="normal">  94</span>
<span class="normal">  95</span>
<span class="normal">  96</span>
<span class="normal">  97</span>
<span class="normal">  98</span>
<span class="normal">  99</span>
<span class="normal"> 100</span>
<span class="normal"> 101</span>
<span class="normal"> 102</span>
<span class="normal"> 103</span>
<span class="normal"> 104</span>
<span class="normal"> 105</span>
<span class="normal"> 106</span>
<span class="normal"> 107</span>
<span class="normal"> 108</span>
<span class="normal"> 109</span>
<span class="normal"> 110</span>
<span class="normal"> 111</span>
<span class="normal"> 112</span>
<span class="normal"> 113</span>
<span class="normal"> 114</span>
<span class="normal"> 115</span>
<span class="normal"> 116</span>
<span class="normal"> 117</span>
<span class="normal"> 118</span>
<span class="normal"> 119</span>
<span class="normal"> 120</span>
<span class="normal"> 121</span>
<span class="normal"> 122</span>
<span class="normal"> 123</span>
<span class="normal"> 124</span>
<span class="normal"> 125</span>
<span class="normal"> 126</span>
<span class="normal"> 127</span>
<span class="normal"> 128</span>
<span class="normal"> 129</span>
<span class="normal"> 130</span>
<span class="normal"> 131</span>
<span class="normal"> 132</span>
<span class="normal"> 133</span>
<span class="normal"> 134</span>
<span class="normal"> 135</span>
<span class="normal"> 136</span>
<span class="normal"> 137</span>
<span class="normal"> 138</span>
<span class="normal"> 139</span>
<span class="normal"> 140</span>
<span class="normal"> 141</span>
<span class="normal"> 142</span>
<span class="normal"> 143</span>
<span class="normal"> 144</span>
<span class="normal"> 145</span>
<span class="normal"> 146</span>
<span class="normal"> 147</span>
<span class="normal"> 148</span>
<span class="normal"> 149</span>
<span class="normal"> 150</span>
<span class="normal"> 151</span>
<span class="normal"> 152</span>
<span class="normal"> 153</span>
<span class="normal"> 154</span>
<span class="normal"> 155</span>
<span class="normal"> 156</span>
<span class="normal"> 157</span>
<span class="normal"> 158</span>
<span class="normal"> 159</span>
<span class="normal"> 160</span>
<span class="normal"> 161</span>
<span class="normal"> 162</span>
<span class="normal"> 163</span>
<span class="normal"> 164</span>
<span class="normal"> 165</span>
<span class="normal"> 166</span>
<span class="normal"> 167</span>
<span class="normal"> 168</span>
<span class="normal"> 169</span>
<span class="normal"> 170</span>
<span class="normal"> 171</span>
<span class="normal"> 172</span>
<span class="normal"> 173</span>
<span class="normal"> 174</span>
<span class="normal"> 175</span>
<span class="normal"> 176</span>
<span class="normal"> 177</span>
<span class="normal"> 178</span>
<span class="normal"> 179</span>
<span class="normal"> 180</span>
<span class="normal"> 181</span>
<span class="normal"> 182</span>
<span class="normal"> 183</span>
<span class="normal"> 184</span>
<span class="normal"> 185</span>
<span class="normal"> 186</span>
<span class="normal"> 187</span>
<span class="normal"> 188</span>
<span class="normal"> 189</span>
<span class="normal"> 190</span>
<span class="normal"> 191</span>
<span class="normal"> 192</span>
<span class="normal"> 193</span>
<span class="normal"> 194</span>
<span class="normal"> 195</span>
<span class="normal"> 196</span>
<span class="normal"> 197</span>
<span class="normal"> 198</span>
<span class="normal"> 199</span>
<span class="normal"> 200</span>
<span class="normal"> 201</span>
<span class="normal"> 202</span>
<span class="normal"> 203</span>
<span class="normal"> 204</span>
<span class="normal"> 205</span>
<span class="normal"> 206</span>
<span class="normal"> 207</span>
<span class="normal"> 208</span>
<span class="normal"> 209</span>
<span class="normal"> 210</span>
<span class="normal"> 211</span>
<span class="normal"> 212</span>
<span class="normal"> 213</span>
<span class="normal"> 214</span>
<span class="normal"> 215</span>
<span class="normal"> 216</span>
<span class="normal"> 217</span>
<span class="normal"> 218</span>
<span class="normal"> 219</span>
<span class="normal"> 220</span>
<span class="normal"> 221</span>
<span class="normal"> 222</span>
<span class="normal"> 223</span>
<span class="normal"> 224</span>
<span class="normal"> 225</span>
<span class="normal"> 226</span>
<span class="normal"> 227</span>
<span class="normal"> 228</span>
<span class="normal"> 229</span>
<span class="normal"> 230</span>
<span class="normal"> 231</span>
<span class="normal"> 232</span>
<span class="normal"> 233</span>
<span class="normal"> 234</span>
<span class="normal"> 235</span>
<span class="normal"> 236</span>
<span class="normal"> 237</span>
<span class="normal"> 238</span>
<span class="normal"> 239</span>
<span class="normal"> 240</span>
<span class="normal"> 241</span>
<span class="normal"> 242</span>
<span class="normal"> 243</span>
<span class="normal"> 244</span>
<span class="normal"> 245</span>
<span class="normal"> 246</span>
<span class="normal"> 247</span>
<span class="normal"> 248</span>
<span class="normal"> 249</span>
<span class="normal"> 250</span>
<span class="normal"> 251</span>
<span class="normal"> 252</span>
<span class="normal"> 253</span>
<span class="normal"> 254</span>
<span class="normal"> 255</span>
<span class="normal"> 256</span>
<span class="normal"> 257</span>
<span class="normal"> 258</span>
<span class="normal"> 259</span>
<span class="normal"> 260</span>
<span class="normal"> 261</span>
<span class="normal"> 262</span>
<span class="normal"> 263</span>
<span class="normal"> 264</span>
<span class="normal"> 265</span>
<span class="normal"> 266</span>
<span class="normal"> 267</span>
<span class="normal"> 268</span>
<span class="normal"> 269</span>
<span class="normal"> 270</span>
<span class="normal"> 271</span>
<span class="normal"> 272</span>
<span class="normal"> 273</span>
<span class="normal"> 274</span>
<span class="normal"> 275</span>
<span class="normal"> 276</span>
<span class="normal"> 277</span>
<span class="normal"> 278</span>
<span class="normal"> 279</span>
<span class="normal"> 280</span>
<span class="normal"> 281</span>
<span class="normal"> 282</span>
<span class="normal"> 283</span>
<span class="normal"> 284</span>
<span class="normal"> 285</span>
<span class="normal"> 286</span>
<span class="normal"> 287</span>
<span class="normal"> 288</span>
<span class="normal"> 289</span>
<span class="normal"> 290</span>
<span class="normal"> 291</span>
<span class="normal"> 292</span>
<span class="normal"> 293</span>
<span class="normal"> 294</span>
<span class="normal"> 295</span>
<span class="normal"> 296</span>
<span class="normal"> 297</span>
<span class="normal"> 298</span>
<span class="normal"> 299</span>
<span class="normal"> 300</span>
<span class="normal"> 301</span>
<span class="normal"> 302</span>
<span class="normal"> 303</span>
<span class="normal"> 304</span>
<span class="normal"> 305</span>
<span class="normal"> 306</span>
<span class="normal"> 307</span>
<span class="normal"> 308</span>
<span class="normal"> 309</span>
<span class="normal"> 310</span>
<span class="normal"> 311</span>
<span class="normal"> 312</span>
<span class="normal"> 313</span>
<span class="normal"> 314</span>
<span class="normal"> 315</span>
<span class="normal"> 316</span>
<span class="normal"> 317</span>
<span class="normal"> 318</span>
<span class="normal"> 319</span>
<span class="normal"> 320</span>
<span class="normal"> 321</span>
<span class="normal"> 322</span>
<span class="normal"> 323</span>
<span class="normal"> 324</span>
<span class="normal"> 325</span>
<span class="normal"> 326</span>
<span class="normal"> 327</span>
<span class="normal"> 328</span>
<span class="normal"> 329</span>
<span class="normal"> 330</span>
<span class="normal"> 331</span>
<span class="normal"> 332</span>
<span class="normal"> 333</span>
<span class="normal"> 334</span>
<span class="normal"> 335</span>
<span class="normal"> 336</span>
<span class="normal"> 337</span>
<span class="normal"> 338</span>
<span class="normal"> 339</span>
<span class="normal"> 340</span>
<span class="normal"> 341</span>
<span class="normal"> 342</span>
<span class="normal"> 343</span>
<span class="normal"> 344</span>
<span class="normal"> 345</span>
<span class="normal"> 346</span>
<span class="normal"> 347</span>
<span class="normal"> 348</span>
<span class="normal"> 349</span>
<span class="normal"> 350</span>
<span class="normal"> 351</span>
<span class="normal"> 352</span>
<span class="normal"> 353</span>
<span class="normal"> 354</span>
<span class="normal"> 355</span>
<span class="normal"> 356</span>
<span class="normal"> 357</span>
<span class="normal"> 358</span>
<span class="normal"> 359</span>
<span class="normal"> 360</span>
<span class="normal"> 361</span>
<span class="normal"> 362</span>
<span class="normal"> 363</span>
<span class="normal"> 364</span>
<span class="normal"> 365</span>
<span class="normal"> 366</span>
<span class="normal"> 367</span>
<span class="normal"> 368</span>
<span class="normal"> 369</span>
<span class="normal"> 370</span>
<span class="normal"> 371</span>
<span class="normal"> 372</span>
<span class="normal"> 373</span>
<span class="normal"> 374</span>
<span class="normal"> 375</span>
<span class="normal"> 376</span>
<span class="normal"> 377</span>
<span class="normal"> 378</span>
<span class="normal"> 379</span>
<span class="normal"> 380</span>
<span class="normal"> 381</span>
<span class="normal"> 382</span>
<span class="normal"> 383</span>
<span class="normal"> 384</span>
<span class="normal"> 385</span>
<span class="normal"> 386</span>
<span class="normal"> 387</span>
<span class="normal"> 388</span>
<span class="normal"> 389</span>
<span class="normal"> 390</span>
<span class="normal"> 391</span>
<span class="normal"> 392</span>
<span class="normal"> 393</span>
<span class="normal"> 394</span>
<span class="normal"> 395</span>
<span class="normal"> 396</span>
<span class="normal"> 397</span>
<span class="normal"> 398</span>
<span class="normal"> 399</span>
<span class="normal"> 400</span>
<span class="normal"> 401</span>
<span class="normal"> 402</span>
<span class="normal"> 403</span>
<span class="normal"> 404</span>
<span class="normal"> 405</span>
<span class="normal"> 406</span>
<span class="normal"> 407</span>
<span class="normal"> 408</span>
<span class="normal"> 409</span>
<span class="normal"> 410</span>
<span class="normal"> 411</span>
<span class="normal"> 412</span>
<span class="normal"> 413</span>
<span class="normal"> 414</span>
<span class="normal"> 415</span>
<span class="normal"> 416</span>
<span class="normal"> 417</span>
<span class="normal"> 418</span>
<span class="normal"> 419</span>
<span class="normal"> 420</span>
<span class="normal"> 421</span>
<span class="normal"> 422</span>
<span class="normal"> 423</span>
<span class="normal"> 424</span>
<span class="normal"> 425</span>
<span class="normal"> 426</span>
<span class="normal"> 427</span>
<span class="normal"> 428</span>
<span class="normal"> 429</span>
<span class="normal"> 430</span>
<span class="normal"> 431</span>
<span class="normal"> 432</span>
<span class="normal"> 433</span>
<span class="normal"> 434</span>
<span class="normal"> 435</span>
<span class="normal"> 436</span>
<span class="normal"> 437</span>
<span class="normal"> 438</span>
<span class="normal"> 439</span>
<span class="normal"> 440</span>
<span class="normal"> 441</span>
<span class="normal"> 442</span>
<span class="normal"> 443</span>
<span class="normal"> 444</span>
<span class="normal"> 445</span>
<span class="normal"> 446</span>
<span class="normal"> 447</span>
<span class="normal"> 448</span>
<span class="normal"> 449</span>
<span class="normal"> 450</span>
<span class="normal"> 451</span>
<span class="normal"> 452</span>
<span class="normal"> 453</span>
<span class="normal"> 454</span>
<span class="normal"> 455</span>
<span class="normal"> 456</span>
<span class="normal"> 457</span>
<span class="normal"> 458</span>
<span class="normal"> 459</span>
<span class="normal"> 460</span>
<span class="normal"> 461</span>
<span class="normal"> 462</span>
<span class="normal"> 463</span>
<span class="normal"> 464</span>
<span class="normal"> 465</span>
<span class="normal"> 466</span>
<span class="normal"> 467</span>
<span class="normal"> 468</span>
<span class="normal"> 469</span>
<span class="normal"> 470</span>
<span class="normal"> 471</span>
<span class="normal"> 472</span>
<span class="normal"> 473</span>
<span class="normal"> 474</span>
<span class="normal"> 475</span>
<span class="normal"> 476</span>
<span class="normal"> 477</span>
<span class="normal"> 478</span>
<span class="normal"> 479</span>
<span class="normal"> 480</span>
<span class="normal"> 481</span>
<span class="normal"> 482</span>
<span class="normal"> 483</span>
<span class="normal"> 484</span>
<span class="normal"> 485</span>
<span class="normal"> 486</span>
<span class="normal"> 487</span>
<span class="normal"> 488</span>
<span class="normal"> 489</span>
<span class="normal"> 490</span>
<span class="normal"> 491</span>
<span class="normal"> 492</span>
<span class="normal"> 493</span>
<span class="normal"> 494</span>
<span class="normal"> 495</span>
<span class="normal"> 496</span>
<span class="normal"> 497</span>
<span class="normal"> 498</span>
<span class="normal"> 499</span>
<span class="normal"> 500</span>
<span class="normal"> 501</span>
<span class="normal"> 502</span>
<span class="normal"> 503</span>
<span class="normal"> 504</span>
<span class="normal"> 505</span>
<span class="normal"> 506</span>
<span class="normal"> 507</span>
<span class="normal"> 508</span>
<span class="normal"> 509</span>
<span class="normal"> 510</span>
<span class="normal"> 511</span>
<span class="normal"> 512</span>
<span class="normal"> 513</span>
<span class="normal"> 514</span>
<span class="normal"> 515</span>
<span class="normal"> 516</span>
<span class="normal"> 517</span>
<span class="normal"> 518</span>
<span class="normal"> 519</span>
<span class="normal"> 520</span>
<span class="normal"> 521</span>
<span class="normal"> 522</span>
<span class="normal"> 523</span>
<span class="normal"> 524</span>
<span class="normal"> 525</span>
<span class="normal"> 526</span>
<span class="normal"> 527</span>
<span class="normal"> 528</span>
<span class="normal"> 529</span>
<span class="normal"> 530</span>
<span class="normal"> 531</span>
<span class="normal"> 532</span>
<span class="normal"> 533</span>
<span class="normal"> 534</span>
<span class="normal"> 535</span>
<span class="normal"> 536</span>
<span class="normal"> 537</span>
<span class="normal"> 538</span>
<span class="normal"> 539</span>
<span class="normal"> 540</span>
<span class="normal"> 541</span>
<span class="normal"> 542</span>
<span class="normal"> 543</span>
<span class="normal"> 544</span>
<span class="normal"> 545</span>
<span class="normal"> 546</span>
<span class="normal"> 547</span>
<span class="normal"> 548</span>
<span class="normal"> 549</span>
<span class="normal"> 550</span>
<span class="normal"> 551</span>
<span class="normal"> 552</span>
<span class="normal"> 553</span>
<span class="normal"> 554</span>
<span class="normal"> 555</span>
<span class="normal"> 556</span>
<span class="normal"> 557</span>
<span class="normal"> 558</span>
<span class="normal"> 559</span>
<span class="normal"> 560</span>
<span class="normal"> 561</span>
<span class="normal"> 562</span>
<span class="normal"> 563</span>
<span class="normal"> 564</span>
<span class="normal"> 565</span>
<span class="normal"> 566</span>
<span class="normal"> 567</span>
<span class="normal"> 568</span>
<span class="normal"> 569</span>
<span class="normal"> 570</span>
<span class="normal"> 571</span>
<span class="normal"> 572</span>
<span class="normal"> 573</span>
<span class="normal"> 574</span>
<span class="normal"> 575</span>
<span class="normal"> 576</span>
<span class="normal"> 577</span>
<span class="normal"> 578</span>
<span class="normal"> 579</span>
<span class="normal"> 580</span>
<span class="normal"> 581</span>
<span class="normal"> 582</span>
<span class="normal"> 583</span>
<span class="normal"> 584</span>
<span class="normal"> 585</span>
<span class="normal"> 586</span>
<span class="normal"> 587</span>
<span class="normal"> 588</span>
<span class="normal"> 589</span>
<span class="normal"> 590</span>
<span class="normal"> 591</span>
<span class="normal"> 592</span>
<span class="normal"> 593</span>
<span class="normal"> 594</span>
<span class="normal"> 595</span>
<span class="normal"> 596</span>
<span class="normal"> 597</span>
<span class="normal"> 598</span>
<span class="normal"> 599</span>
<span class="normal"> 600</span>
<span class="normal"> 601</span>
<span class="normal"> 602</span>
<span class="normal"> 603</span>
<span class="normal"> 604</span>
<span class="normal"> 605</span>
<span class="normal"> 606</span>
<span class="normal"> 607</span>
<span class="normal"> 608</span>
<span class="normal"> 609</span>
<span class="normal"> 610</span>
<span class="normal"> 611</span>
<span class="normal"> 612</span>
<span class="normal"> 613</span>
<span class="normal"> 614</span>
<span class="normal"> 615</span>
<span class="normal"> 616</span>
<span class="normal"> 617</span>
<span class="normal"> 618</span>
<span class="normal"> 619</span>
<span class="normal"> 620</span>
<span class="normal"> 621</span>
<span class="normal"> 622</span>
<span class="normal"> 623</span>
<span class="normal"> 624</span>
<span class="normal"> 625</span>
<span class="normal"> 626</span>
<span class="normal"> 627</span>
<span class="normal"> 628</span>
<span class="normal"> 629</span>
<span class="normal"> 630</span>
<span class="normal"> 631</span>
<span class="normal"> 632</span>
<span class="normal"> 633</span>
<span class="normal"> 634</span>
<span class="normal"> 635</span>
<span class="normal"> 636</span>
<span class="normal"> 637</span>
<span class="normal"> 638</span>
<span class="normal"> 639</span>
<span class="normal"> 640</span>
<span class="normal"> 641</span>
<span class="normal"> 642</span>
<span class="normal"> 643</span>
<span class="normal"> 644</span>
<span class="normal"> 645</span>
<span class="normal"> 646</span>
<span class="normal"> 647</span>
<span class="normal"> 648</span>
<span class="normal"> 649</span>
<span class="normal"> 650</span>
<span class="normal"> 651</span>
<span class="normal"> 652</span>
<span class="normal"> 653</span>
<span class="normal"> 654</span>
<span class="normal"> 655</span>
<span class="normal"> 656</span>
<span class="normal"> 657</span>
<span class="normal"> 658</span>
<span class="normal"> 659</span>
<span class="normal"> 660</span>
<span class="normal"> 661</span>
<span class="normal"> 662</span>
<span class="normal"> 663</span>
<span class="normal"> 664</span>
<span class="normal"> 665</span>
<span class="normal"> 666</span>
<span class="normal"> 667</span>
<span class="normal"> 668</span>
<span class="normal"> 669</span>
<span class="normal"> 670</span>
<span class="normal"> 671</span>
<span class="normal"> 672</span>
<span class="normal"> 673</span>
<span class="normal"> 674</span>
<span class="normal"> 675</span>
<span class="normal"> 676</span>
<span class="normal"> 677</span>
<span class="normal"> 678</span>
<span class="normal"> 679</span>
<span class="normal"> 680</span>
<span class="normal"> 681</span>
<span class="normal"> 682</span>
<span class="normal"> 683</span>
<span class="normal"> 684</span>
<span class="normal"> 685</span>
<span class="normal"> 686</span>
<span class="normal"> 687</span>
<span class="normal"> 688</span>
<span class="normal"> 689</span>
<span class="normal"> 690</span>
<span class="normal"> 691</span>
<span class="normal"> 692</span>
<span class="normal"> 693</span>
<span class="normal"> 694</span>
<span class="normal"> 695</span>
<span class="normal"> 696</span>
<span class="normal"> 697</span>
<span class="normal"> 698</span>
<span class="normal"> 699</span>
<span class="normal"> 700</span>
<span class="normal"> 701</span>
<span class="normal"> 702</span>
<span class="normal"> 703</span>
<span class="normal"> 704</span>
<span class="normal"> 705</span>
<span class="normal"> 706</span>
<span class="normal"> 707</span>
<span class="normal"> 708</span>
<span class="normal"> 709</span>
<span class="normal"> 710</span>
<span class="normal"> 711</span>
<span class="normal"> 712</span>
<span class="normal"> 713</span>
<span class="normal"> 714</span>
<span class="normal"> 715</span>
<span class="normal"> 716</span>
<span class="normal"> 717</span>
<span class="normal"> 718</span>
<span class="normal"> 719</span>
<span class="normal"> 720</span>
<span class="normal"> 721</span>
<span class="normal"> 722</span>
<span class="normal"> 723</span>
<span class="normal"> 724</span>
<span class="normal"> 725</span>
<span class="normal"> 726</span>
<span class="normal"> 727</span>
<span class="normal"> 728</span>
<span class="normal"> 729</span>
<span class="normal"> 730</span>
<span class="normal"> 731</span>
<span class="normal"> 732</span>
<span class="normal"> 733</span>
<span class="normal"> 734</span>
<span class="normal"> 735</span>
<span class="normal"> 736</span>
<span class="normal"> 737</span>
<span class="normal"> 738</span>
<span class="normal"> 739</span>
<span class="normal"> 740</span>
<span class="normal"> 741</span>
<span class="normal"> 742</span>
<span class="normal"> 743</span>
<span class="normal"> 744</span>
<span class="normal"> 745</span>
<span class="normal"> 746</span>
<span class="normal"> 747</span>
<span class="normal"> 748</span>
<span class="normal"> 749</span>
<span class="normal"> 750</span>
<span class="normal"> 751</span>
<span class="normal"> 752</span>
<span class="normal"> 753</span>
<span class="normal"> 754</span>
<span class="normal"> 755</span>
<span class="normal"> 756</span>
<span class="normal"> 757</span>
<span class="normal"> 758</span>
<span class="normal"> 759</span>
<span class="normal"> 760</span>
<span class="normal"> 761</span>
<span class="normal"> 762</span>
<span class="normal"> 763</span>
<span class="normal"> 764</span>
<span class="normal"> 765</span>
<span class="normal"> 766</span>
<span class="normal"> 767</span>
<span class="normal"> 768</span>
<span class="normal"> 769</span>
<span class="normal"> 770</span>
<span class="normal"> 771</span>
<span class="normal"> 772</span>
<span class="normal"> 773</span>
<span class="normal"> 774</span>
<span class="normal"> 775</span>
<span class="normal"> 776</span>
<span class="normal"> 777</span>
<span class="normal"> 778</span>
<span class="normal"> 779</span>
<span class="normal"> 780</span>
<span class="normal"> 781</span>
<span class="normal"> 782</span>
<span class="normal"> 783</span>
<span class="normal"> 784</span>
<span class="normal"> 785</span>
<span class="normal"> 786</span>
<span class="normal"> 787</span>
<span class="normal"> 788</span>
<span class="normal"> 789</span>
<span class="normal"> 790</span>
<span class="normal"> 791</span>
<span class="normal"> 792</span>
<span class="normal"> 793</span>
<span class="normal"> 794</span>
<span class="normal"> 795</span>
<span class="normal"> 796</span>
<span class="normal"> 797</span>
<span class="normal"> 798</span>
<span class="normal"> 799</span>
<span class="normal"> 800</span>
<span class="normal"> 801</span>
<span class="normal"> 802</span>
<span class="normal"> 803</span>
<span class="normal"> 804</span>
<span class="normal"> 805</span>
<span class="normal"> 806</span>
<span class="normal"> 807</span>
<span class="normal"> 808</span>
<span class="normal"> 809</span>
<span class="normal"> 810</span>
<span class="normal"> 811</span>
<span class="normal"> 812</span>
<span class="normal"> 813</span>
<span class="normal"> 814</span>
<span class="normal"> 815</span>
<span class="normal"> 816</span>
<span class="normal"> 817</span>
<span class="normal"> 818</span>
<span class="normal"> 819</span>
<span class="normal"> 820</span>
<span class="normal"> 821</span>
<span class="normal"> 822</span>
<span class="normal"> 823</span>
<span class="normal"> 824</span>
<span class="normal"> 825</span>
<span class="normal"> 826</span>
<span class="normal"> 827</span>
<span class="normal"> 828</span>
<span class="normal"> 829</span>
<span class="normal"> 830</span>
<span class="normal"> 831</span>
<span class="normal"> 832</span>
<span class="normal"> 833</span>
<span class="normal"> 834</span>
<span class="normal"> 835</span>
<span class="normal"> 836</span>
<span class="normal"> 837</span>
<span class="normal"> 838</span>
<span class="normal"> 839</span>
<span class="normal"> 840</span>
<span class="normal"> 841</span>
<span class="normal"> 842</span>
<span class="normal"> 843</span>
<span class="normal"> 844</span>
<span class="normal"> 845</span>
<span class="normal"> 846</span>
<span class="normal"> 847</span>
<span class="normal"> 848</span>
<span class="normal"> 849</span>
<span class="normal"> 850</span>
<span class="normal"> 851</span>
<span class="normal"> 852</span>
<span class="normal"> 853</span>
<span class="normal"> 854</span>
<span class="normal"> 855</span>
<span class="normal"> 856</span>
<span class="normal"> 857</span>
<span class="normal"> 858</span>
<span class="normal"> 859</span>
<span class="normal"> 860</span>
<span class="normal"> 861</span>
<span class="normal"> 862</span>
<span class="normal"> 863</span>
<span class="normal"> 864</span>
<span class="normal"> 865</span>
<span class="normal"> 866</span>
<span class="normal"> 867</span>
<span class="normal"> 868</span>
<span class="normal"> 869</span>
<span class="normal"> 870</span>
<span class="normal"> 871</span>
<span class="normal"> 872</span>
<span class="normal"> 873</span>
<span class="normal"> 874</span>
<span class="normal"> 875</span>
<span class="normal"> 876</span>
<span class="normal"> 877</span>
<span class="normal"> 878</span>
<span class="normal"> 879</span>
<span class="normal"> 880</span>
<span class="normal"> 881</span>
<span class="normal"> 882</span>
<span class="normal"> 883</span>
<span class="normal"> 884</span>
<span class="normal"> 885</span>
<span class="normal"> 886</span>
<span class="normal"> 887</span>
<span class="normal"> 888</span>
<span class="normal"> 889</span>
<span class="normal"> 890</span>
<span class="normal"> 891</span>
<span class="normal"> 892</span>
<span class="normal"> 893</span>
<span class="normal"> 894</span>
<span class="normal"> 895</span>
<span class="normal"> 896</span>
<span class="normal"> 897</span>
<span class="normal"> 898</span>
<span class="normal"> 899</span>
<span class="normal"> 900</span>
<span class="normal"> 901</span>
<span class="normal"> 902</span>
<span class="normal"> 903</span>
<span class="normal"> 904</span>
<span class="normal"> 905</span>
<span class="normal"> 906</span>
<span class="normal"> 907</span>
<span class="normal"> 908</span>
<span class="normal"> 909</span>
<span class="normal"> 910</span>
<span class="normal"> 911</span>
<span class="normal"> 912</span>
<span class="normal"> 913</span>
<span class="normal"> 914</span>
<span class="normal"> 915</span>
<span class="normal"> 916</span>
<span class="normal"> 917</span>
<span class="normal"> 918</span>
<span class="normal"> 919</span>
<span class="normal"> 920</span>
<span class="normal"> 921</span>
<span class="normal"> 922</span>
<span class="normal"> 923</span>
<span class="normal"> 924</span>
<span class="normal"> 925</span>
<span class="normal"> 926</span>
<span class="normal"> 927</span>
<span class="normal"> 928</span>
<span class="normal"> 929</span>
<span class="normal"> 930</span>
<span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">UtilitiesContainer</span><span class="p">(</span><span class="n">ScrollableContainer</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    A widget to work with images and labels in the napari viewer.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    viewer: napari.viewer.Viewer, optional</span>
<span class="sd">        The napari viewer instance.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    _viewer: napari.viewer.Viewer</span>
<span class="sd">        The napari viewer instance.</span>
<span class="sd">    _image_save_dims: str or None</span>
<span class="sd">        The dimension order for saving images.</span>
<span class="sd">    _label_save_dims: str or None</span>
<span class="sd">        The dimension order for saving labels.</span>
<span class="sd">    _p_sizes: PhysicalPixelSizes</span>
<span class="sd">        The physical pixel sizes for the image.</span>
<span class="sd">    _files: FileEdit</span>
<span class="sd">        Widget for selecting file(s).</span>
<span class="sd">    _open_image_button: PushButton</span>
<span class="sd">        Button for opening images.</span>
<span class="sd">    _save_directory: FileEdit</span>
<span class="sd">        Widget for selecting the save directory.</span>
<span class="sd">    _save_name: LineEdit</span>
<span class="sd">        Widget for entering the file save name.</span>
<span class="sd">    _metadata_from_selected_layer: PushButton</span>
<span class="sd">        Button for updating metadata from the selected layer.</span>
<span class="sd">    _dim_order: LineEdit</span>
<span class="sd">        Widget for entering the dimension order.</span>
<span class="sd">    _channel_names: LineEdit</span>
<span class="sd">        Widget for entering the channel names.</span>
<span class="sd">    _physical_pixel_sizes_z: FloatSpinBox</span>
<span class="sd">        Widget for entering the Z pixel size in micrometers.</span>
<span class="sd">    _physical_pixel_sizes_y: FloatSpinBox</span>
<span class="sd">        Widget for entering the Y pixel size in micrometers.</span>
<span class="sd">    _physical_pixel_sizes_x: FloatSpinBox</span>
<span class="sd">        Widget for entering the X pixel size in micrometers.</span>
<span class="sd">    _image_layer: Select</span>
<span class="sd">        Widget for selecting the image layer.</span>
<span class="sd">    _concatenate_image_files: CheckBox</span>
<span class="sd">        Checkbox for concatenating image files.</span>
<span class="sd">    _concatenate_image_layers: CheckBox</span>
<span class="sd">        Checkbox for concatenating image layers.</span>
<span class="sd">    _save_image_button: PushButton</span>
<span class="sd">        Button for saving images.</span>
<span class="sd">    _labels_layer: Widget</span>
<span class="sd">        Widget for working with labels layer.</span>
<span class="sd">    _save_labels_button: PushButton</span>
<span class="sd">        Button for saving labels.</span>
<span class="sd">    _shapes_layer: Widget</span>
<span class="sd">        Widget for working with shapes layer.</span>
<span class="sd">    _save_shapes_button: PushButton</span>
<span class="sd">        Button for saving shapes as labels.</span>
<span class="sd">    _results: TextEdit</span>
<span class="sd">        Widget for displaying information.</span>

<span class="sd">    Methods</span>
<span class="sd">    -------</span>
<span class="sd">    _update_metadata(img)</span>
<span class="sd">        Update the metadata based on the given image.</span>
<span class="sd">    update_metadata_from_file()</span>
<span class="sd">        Update the metadata from the selected file.</span>
<span class="sd">    update_metadata_from_layer()</span>
<span class="sd">        Update the metadata from the selected layer.</span>
<span class="sd">    open_images()</span>
<span class="sd">        Open the selected images in the napari viewer.</span>
<span class="sd">    concatenate_images(concatenate_files, files, concatenate_layers, layers)</span>
<span class="sd">        Concatenate the image data based on the selected options.</span>
<span class="sd">    p_sizes()</span>
<span class="sd">        Get the physical pixel sizes.</span>
<span class="sd">    _get_save_loc(parent)</span>
<span class="sd">        Get the save location based on the parent directory.</span>
<span class="sd">    _common_save_logic(data, uri, dim_order, channel_names, layer)</span>
<span class="sd">        Common logic for saving data as OME-TIFF.</span>
<span class="sd">    save_ome_tiff()</span>
<span class="sd">        Save the concatenated image data as OME-TIFF.</span>
<span class="sd">    save_labels()</span>
<span class="sd">        Save the labels data.</span>
<span class="sd">    save_shapes_as_labels()</span>
<span class="sd">        Save the shapes data as labels.</span>

<span class="sd">    """</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">viewer</span><span class="p">:</span> <span class="n">napari</span><span class="o">.</span><span class="n">viewer</span><span class="o">.</span><span class="n">Viewer</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Initialize the UtilitiesContainer widget.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        viewer : napari.viewer.Viewer, optional</span>
<span class="sd">            The napari viewer instance.</span>

<span class="sd">        """</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">min_width</span> <span class="o">=</span> <span class="mi">500</span> <span class="c1"># TODO: remove this hardcoded value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_viewer</span> <span class="o">=</span> <span class="n">viewer</span> <span class="k">if</span> <span class="n">viewer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_squeezed_dims_order</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_squeezed_dims</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_settings</span> <span class="o">=</span> <span class="n">get_settings</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_init_widgets</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_init_save_name_container</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_init_open_image_container</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_init_metadata_container</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_init_concatenate_files_container</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_init_save_layers_container</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_init_scene_container</span><span class="p">()</span>
        <span class="c1"># self._init_figure_options_container() # TODO: add figure saving</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_init_layout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_connect_events</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_init_widgets</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Initialize widgets."""</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_save_directory_prefix</span> <span class="o">=</span> <span class="n">LineEdit</span><span class="p">(</span>
            <span class="n">label</span><span class="o">=</span><span class="s1">'Save Dir. Prefix'</span><span class="p">,</span>
            <span class="n">tooltip</span><span class="o">=</span><span class="s1">'Prefix for the save directories.'</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_save_directory</span> <span class="o">=</span> <span class="n">FileEdit</span><span class="p">(</span>
            <span class="n">mode</span><span class="o">=</span><span class="s1">'d'</span><span class="p">,</span>
            <span class="n">tooltip</span><span class="o">=</span><span class="s1">'Directory where images will be saved. </span><span class="se">\n</span><span class="s1">'</span>
            <span class="s1">'Upon selecting the first file, the save directory will be set </span><span class="se">\n</span><span class="s1">'</span>
            <span class="s1">'to the grandparent directory of the first file.'</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_save_directory_container</span> <span class="o">=</span> <span class="n">Container</span><span class="p">(</span>
            <span class="n">widgets</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_save_directory_prefix</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_save_directory</span><span class="p">],</span>
            <span class="n">layout</span><span class="o">=</span><span class="s1">'horizontal'</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_default_save_directory</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_save_directory</span><span class="o">.</span><span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_files</span> <span class="o">=</span> <span class="n">FileEdit</span><span class="p">(</span>
            <span class="n">mode</span><span class="o">=</span><span class="s1">'rm'</span><span class="p">,</span>
            <span class="n">tooltip</span><span class="o">=</span><span class="s1">'Select file(s) to load.'</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_results</span> <span class="o">=</span> <span class="n">TextEdit</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">'Info'</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_init_save_name_container</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Initialize the save name container."""</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_save_name_container</span> <span class="o">=</span> <span class="n">Container</span><span class="p">(</span><span class="n">layout</span><span class="o">=</span><span class="s1">'horizontal'</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_save_name</span> <span class="o">=</span> <span class="n">LineEdit</span><span class="p">(</span>
            <span class="n">label</span><span class="o">=</span><span class="s1">'Save Name'</span><span class="p">,</span>
            <span class="n">tooltip</span><span class="o">=</span><span class="s1">'Name of the saved file. '</span>
            <span class="s1">'Proper extension will be added when saved.'</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_append_scene_button</span> <span class="o">=</span> <span class="n">PushButton</span><span class="p">(</span>
            <span class="n">label</span><span class="o">=</span><span class="s1">'Append Scene to Name'</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_save_name_container</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_save_name</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_append_scene_button</span>
        <span class="p">])</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_init_open_image_container</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Initialize the open image container."""</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_open_image_container</span> <span class="o">=</span> <span class="n">Container</span><span class="p">(</span><span class="n">layout</span><span class="o">=</span><span class="s1">'horizontal'</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_open_image_button</span> <span class="o">=</span> <span class="n">PushButton</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">'Open File(s)'</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_select_next_image_button</span> <span class="o">=</span> <span class="n">PushButton</span><span class="p">(</span>
            <span class="n">label</span><span class="o">=</span><span class="s1">'Select Next'</span><span class="p">,</span>
            <span class="n">tooltip</span><span class="o">=</span><span class="s1">'Select the next file(s) in the directory. </span><span class="se">\n</span><span class="s1">'</span>
            <span class="s1">'Note that the files are sorted alphabetically and numerically.'</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_open_image_container</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_open_image_button</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_open_image_container</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_select_next_image_button</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_init_concatenate_files_container</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_concatenate_files_container</span> <span class="o">=</span> <span class="n">Container</span><span class="p">(</span>
            <span class="n">layout</span><span class="o">=</span><span class="s1">'horizontal'</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_concatenate_files_button</span> <span class="o">=</span> <span class="n">PushButton</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">'Concat. Files'</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_concatenate_batch_button</span> <span class="o">=</span> <span class="n">PushButton</span><span class="p">(</span>
            <span class="n">label</span><span class="o">=</span><span class="s1">'Batch Concat.'</span><span class="p">,</span>
            <span class="n">tooltip</span><span class="o">=</span><span class="s1">'Concatenate files in the selected directory by iterating'</span>
            <span class="s1">' over the remaing files in the directory based on the number of'</span>
            <span class="s1">' files selected. The files are sorted '</span>
            <span class="s1">'alphabetically and numerically, which may not be consistent '</span>
            <span class="s1">'with your file viewer. But, opening related consecutive files '</span>
            <span class="s1">'should work as expected.'</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_concatenate_files_container</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_concatenate_files_button</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_concatenate_batch_button</span><span class="p">,</span>
        <span class="p">])</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">_init_metadata_container</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_scale</span> <span class="o">=</span> <span class="n">CheckBox</span><span class="p">(</span>
            <span class="n">value</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s1">'Scale'</span><span class="p">,</span>
            <span class="n">tooltip</span><span class="o">=</span><span class="s1">'Update the scale when files are selected.'</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_channel_names</span> <span class="o">=</span> <span class="n">CheckBox</span><span class="p">(</span>
            <span class="n">value</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s1">'Channel Names'</span><span class="p">,</span>
            <span class="n">tooltip</span><span class="o">=</span><span class="s1">'Update the channel names when files are selected.'</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_file_options_container</span> <span class="o">=</span> <span class="n">GroupBoxContainer</span><span class="p">(</span>
            <span class="n">layout</span><span class="o">=</span><span class="s1">'horizontal'</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="s1">'Update Metadata on File Select'</span><span class="p">,</span>
            <span class="n">labels</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">widgets</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_update_scale</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_channel_names</span><span class="p">]</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_layer_metadata_update_button</span> <span class="o">=</span> <span class="n">PushButton</span><span class="p">(</span>
            <span class="n">label</span><span class="o">=</span><span class="s1">'Update from Selected Layer'</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_num_scenes_label</span> <span class="o">=</span> <span class="n">Label</span><span class="p">(</span>
            <span class="n">label</span><span class="o">=</span><span class="s1">'Num. Scenes: '</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dim_shape</span> <span class="o">=</span> <span class="n">LineEdit</span><span class="p">(</span>
            <span class="n">label</span><span class="o">=</span><span class="s1">'Dims: '</span><span class="p">,</span>
            <span class="n">tooltip</span><span class="o">=</span><span class="s1">'Sanity check for available dimensions.'</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_image_info_container</span> <span class="o">=</span> <span class="n">Container</span><span class="p">(</span>
            <span class="n">widgets</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_num_scenes_label</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dim_shape</span><span class="p">],</span>
            <span class="n">layout</span><span class="o">=</span><span class="s1">'horizontal'</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_channel_names</span> <span class="o">=</span> <span class="n">LineEdit</span><span class="p">(</span>
            <span class="n">label</span><span class="o">=</span><span class="s1">'Channel Name(s)'</span><span class="p">,</span>
            <span class="n">tooltip</span><span class="o">=</span><span class="s1">'Enter channel names as a list. If left blank or the '</span>
            <span class="s1">'channel names are not the proper length, then default channel '</span>
            <span class="s1">'names will be used.'</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_scale_tuple</span> <span class="o">=</span> <span class="n">TupleEdit</span><span class="p">(</span>
            <span class="n">label</span><span class="o">=</span><span class="s1">'Scale, ZYX'</span><span class="p">,</span>
            <span class="n">tooltip</span><span class="o">=</span><span class="s1">'Pixel size, usually in μm'</span><span class="p">,</span>
            <span class="n">value</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0000</span><span class="p">,</span> <span class="mf">1.0000</span><span class="p">,</span> <span class="mf">1.0000</span><span class="p">),</span>
            <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s1">'step'</span><span class="p">:</span> <span class="mf">0.0001</span><span class="p">},</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_channel_scale_container</span> <span class="o">=</span> <span class="n">Container</span><span class="p">(</span>
            <span class="n">widgets</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_channel_names</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_scale_tuple</span><span class="p">],</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_scale_layers_button</span> <span class="o">=</span> <span class="n">PushButton</span><span class="p">(</span>
            <span class="n">label</span><span class="o">=</span><span class="s1">'Scale Layer(s)'</span><span class="p">,</span>
            <span class="n">tooltip</span><span class="o">=</span><span class="s1">'Scale the selected layer(s) based on the given scale.'</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_metadata_button_container</span> <span class="o">=</span> <span class="n">Container</span><span class="p">(</span>
            <span class="n">widgets</span><span class="o">=</span><span class="p">[</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_layer_metadata_update_button</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_scale_layers_button</span>
            <span class="p">],</span>
            <span class="n">layout</span><span class="o">=</span><span class="s1">'horizontal'</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_metadata_container</span> <span class="o">=</span> <span class="n">GroupBoxContainer</span><span class="p">(</span>
            <span class="n">layout</span><span class="o">=</span><span class="s1">'vertical'</span><span class="p">,</span>  <span class="c1"># label='Update Metadata from',</span>
            <span class="n">name</span><span class="o">=</span><span class="s1">'Metadata'</span><span class="p">,</span>
            <span class="n">widgets</span><span class="o">=</span><span class="p">[</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_file_options_container</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_image_info_container</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_channel_scale_container</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_metadata_button_container</span><span class="p">,</span>
            <span class="p">],</span>
            <span class="n">labels</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_init_scene_container</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Initialize the scene container, allowing scene saving."""</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_scene_container</span> <span class="o">=</span> <span class="n">Container</span><span class="p">(</span>
            <span class="n">layout</span><span class="o">=</span><span class="s1">'horizontal'</span><span class="p">,</span>
            <span class="n">tooltip</span><span class="o">=</span><span class="s1">'Must be in list index format. Ex: [0, 1, 2] or [5:10]'</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_scenes_to_extract</span> <span class="o">=</span> <span class="n">LineEdit</span><span class="p">(</span>
            <span class="c1"># label="Scenes to Extract",</span>
            <span class="n">tooltip</span><span class="o">=</span><span class="s1">'Enter the scenes to extract as a list. If left blank '</span>
            <span class="s1">'then all scenes will be extracted.'</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_extract_scenes</span> <span class="o">=</span> <span class="n">PushButton</span><span class="p">(</span>
            <span class="n">label</span><span class="o">=</span><span class="s1">'Extract and Save Scenes'</span><span class="p">,</span>
            <span class="n">tooltip</span><span class="o">=</span><span class="s1">'Extract scenes from a single selected file.'</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_scene_container</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_scenes_to_extract</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_scene_container</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_extract_scenes</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_init_save_layers_container</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Initialize the container to save images, labels, and shapes."""</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_save_layers_button</span> <span class="o">=</span> <span class="n">PushButton</span><span class="p">(</span>
            <span class="n">text</span><span class="o">=</span><span class="s1">'Selected Layers (TIFF)'</span><span class="p">,</span>
            <span class="n">tooltip</span><span class="o">=</span><span class="s1">'Concatenate and save all selected layers as OME-TIFF. '</span>
            <span class="s1">'Layers will save to corresponding directories based on the layer '</span>
            <span class="s1">'type, e.g. Images, Labels, ShapesAsLabels. Shapes are saved as '</span>
            <span class="s1">'labels based on the selected image layer dimensions. If multiple '</span>
            <span class="s1">'layer types are selected, then the image will save to Layers.'</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_export_figure_button</span> <span class="o">=</span> <span class="n">PushButton</span><span class="p">(</span>
            <span class="n">text</span><span class="o">=</span><span class="s1">'Figure (PNG)'</span><span class="p">,</span>
            <span class="n">tooltip</span><span class="o">=</span><span class="s1">'Export the current canvas figure as a PNG to the Figure '</span>
            <span class="s1">'directory. Only works in 2D mode. Use Screenshot for 3D figures. '</span>
            <span class="s1">'Crops the figure to the extent of the data, attempting to remove '</span>
            <span class="s1">'margins. Increase or decrease scaling in the settings'</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_export_screenshot_button</span> <span class="o">=</span> <span class="n">PushButton</span><span class="p">(</span>
            <span class="n">text</span><span class="o">=</span><span class="s1">'Canvas (PNG)'</span><span class="p">,</span>
            <span class="n">tooltip</span><span class="o">=</span><span class="s1">'Export the current canvas screenshot as a PNG to the '</span>
            <span class="s1">'Figure directory. Works in 2D and 3D mode. Uses the full canvas '</span>
            <span class="s1">'size, including margins. Increase or decrease scaling in the '</span>
            <span class="s1">'settings, and also it is possible to override the canvas size.'</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_save_layers_container</span> <span class="o">=</span> <span class="n">GroupBoxContainer</span><span class="p">(</span>
            <span class="n">layout</span><span class="o">=</span><span class="s1">'horizontal'</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="s1">'Export'</span><span class="p">,</span>
            <span class="n">labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_save_layers_container</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_save_layers_button</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_export_figure_button</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_export_screenshot_button</span><span class="p">,</span>
        <span class="p">])</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_init_layout</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Initialize the layout of the widget."""</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_file_group</span> <span class="o">=</span> <span class="n">GroupBoxContainer</span><span class="p">(</span>
            <span class="n">widgets</span><span class="o">=</span><span class="p">[</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_files</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_open_image_container</span><span class="p">,</span>
            <span class="p">],</span>
            <span class="n">name</span><span class="o">=</span><span class="s1">'Opening'</span><span class="p">,</span>
            <span class="n">labels</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_save_group</span> <span class="o">=</span> <span class="n">GroupBoxContainer</span><span class="p">(</span>
            <span class="n">widgets</span><span class="o">=</span><span class="p">[</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_save_directory_container</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_save_name_container</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_concatenate_files_container</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_scene_container</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_save_layers_container</span><span class="p">,</span>
            <span class="p">],</span>
            <span class="n">name</span><span class="o">=</span><span class="s1">'Saving'</span><span class="p">,</span>
            <span class="n">labels</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_file_group</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_save_group</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_metadata_container</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_results</span><span class="p">,</span>
            <span class="p">]</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_connect_events</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Connect the events of the widgets to respective methods."""</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_files</span><span class="o">.</span><span class="n">changed</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">update_save_directory</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_files</span><span class="o">.</span><span class="n">changed</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">update_metadata_on_file_select</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_append_scene_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">append_scene_to_name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_open_image_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">open_images</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_select_next_image_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">select_next_images</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_layer_metadata_update_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_metadata_from_layer</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_scale_layers_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rescale_by</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_concatenate_files_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">save_files_as_ome_tiff</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_concatenate_batch_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">batch_concatenate_files</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_extract_scenes</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">save_scenes_ome_tiff</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_save_layers_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">save_layers_as_ome_tiff</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_export_figure_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_export_figure</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_export_screenshot_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_screenshot</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_results</span><span class="o">.</span><span class="n">_on_value_change</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">p_sizes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Get the physical pixel sizes.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        PhysicalPixelSizes</span>
<span class="sd">            The physical pixel sizes.</span>

<span class="sd">        """</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">bioio_base.types</span><span class="w"> </span><span class="kn">import</span> <span class="n">PhysicalPixelSizes</span>

        <span class="k">return</span> <span class="n">PhysicalPixelSizes</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_scale_tuple</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_scale_tuple</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_scale_tuple</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">update_save_directory</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Update the save directory based on the selected files."""</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_save_directory</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_default_save_directory</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_save_directory</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_files</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_update_metadata_from_Image</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">img</span><span class="p">:</span> <span class="n">BioImage</span><span class="p">,</span>
        <span class="n">update_channel_names</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">update_scale</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Update the metadata based on the given image.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        img : BioImage</span>
<span class="sd">            The image from which to update the metadata.</span>
<span class="sd">        update_channel_names : bool, optional</span>
<span class="sd">            Update the channel names, by default True.</span>
<span class="sd">        update_scale : bool, optional</span>
<span class="sd">            Update the scale, by default True.</span>

<span class="sd">        """</span>
        <span class="c1"># get the part of the string between the brackets, which is the dim order</span>
        <span class="n">dims</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">'\[(.*?)\]'</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">dims</span><span class="p">))</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dim_shape</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">dims</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_num_scenes_label</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">scenes</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_squeezed_dims_order</span> <span class="o">=</span> <span class="n">helpers</span><span class="o">.</span><span class="n">get_squeezed_dim_order</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
        <span class="n">dims_tuple</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">d</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_squeezed_dims_order</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_squeezed_dims</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">dims</span><span class="p">[</span><span class="n">dims_tuple</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">update_channel_names</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_channel_names</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">helpers</span><span class="o">.</span><span class="n">get_channel_names</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">update_scale</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_scale_tuple</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">img</span><span class="o">.</span><span class="n">physical_pixel_sizes</span><span class="o">.</span><span class="n">Z</span> <span class="ow">or</span> <span class="mi">1</span><span class="p">,</span>
                <span class="n">img</span><span class="o">.</span><span class="n">physical_pixel_sizes</span><span class="o">.</span><span class="n">Y</span> <span class="ow">or</span> <span class="mi">1</span><span class="p">,</span>
                <span class="n">img</span><span class="o">.</span><span class="n">physical_pixel_sizes</span><span class="o">.</span><span class="n">X</span> <span class="ow">or</span> <span class="mi">1</span><span class="p">,</span>
            <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">update_metadata_on_file_select</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Update self._save_name.value and metadata if selected."""</span>
        <span class="c1"># TODO: get true stem of file, in case .ome.tiff</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_save_name</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_files</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">stem</span><span class="p">)</span>
        <span class="n">img</span> <span class="o">=</span> <span class="n">nImage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_files</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_update_metadata_from_Image</span><span class="p">(</span>
            <span class="n">img</span><span class="p">,</span>
            <span class="n">update_channel_names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_update_channel_names</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
            <span class="n">update_scale</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_update_scale</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">append_scene_to_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Append the scene to the save name."""</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_viewer</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">selection</span><span class="o">.</span><span class="n">active</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">img</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_viewer</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">selection</span><span class="o">.</span><span class="n">active</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">'bioimage'</span><span class="p">]</span>
                <span class="c1"># remove bad characters from scene name</span>
                <span class="n">scene</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">'[^\w\s]'</span><span class="p">,</span> <span class="s1">'-'</span><span class="p">,</span> <span class="n">img</span><span class="o">.</span><span class="n">current_scene</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_save_name</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">'</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_save_name</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">scene</span><span class="si">}</span><span class="s1">'</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_results</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="s1">'Tried to append scene to name, but layer not opened with'</span>
                    <span class="s1">' nDev reader.'</span>
                <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_results</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="p">(</span>
                <span class="s1">'Tried to append scene to name, but no layer selected.'</span>
                <span class="s1">' So the first scene from the first file will be appended.'</span>
            <span class="p">)</span>
            <span class="n">img</span> <span class="o">=</span> <span class="n">nImage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_files</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">scene</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">'[^\w\s]'</span><span class="p">,</span> <span class="s1">'-'</span><span class="p">,</span> <span class="n">img</span><span class="o">.</span><span class="n">current_scene</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_save_name</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">'</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_save_name</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">scene</span><span class="si">}</span><span class="s1">'</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">update_metadata_from_layer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Update metadata from the selected layer.</span>

<span class="sd">        Expects images to be opened with napari-ndev reader.</span>

<span class="sd">        Note:</span>
<span class="sd">        ----</span>
<span class="sd">        This should also support napari-bioio in the future, when released.</span>

<span class="sd">        """</span>
        <span class="n">selected_layer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_viewer</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">selection</span><span class="o">.</span><span class="n">active</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">img</span> <span class="o">=</span> <span class="n">selected_layer</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">'bioimage'</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_update_metadata_from_Image</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_results</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="p">(</span>
                <span class="s1">'Tried to update metadata, but no layer selected.'</span>
                <span class="sa">f</span><span class="s1">'</span><span class="se">\n</span><span class="s1">At </span><span class="si">{</span><span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">"%H:%M:%S"</span><span class="p">)</span><span class="si">}</span><span class="s1">'</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">selected_layer</span><span class="o">.</span><span class="n">scale</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_scale_tuple</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">scale</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">scale</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">3</span> <span class="k">else</span> <span class="mi">1</span><span class="p">,</span>
                <span class="n">scale</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span>
                <span class="n">scale</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_results</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="p">(</span>
                <span class="s1">'Tried to update metadata, but could only update scale'</span>
                <span class="s1">' because layer not opened with nDev reader.'</span>
                <span class="sa">f</span><span class="s1">'</span><span class="se">\n</span><span class="s1">At </span><span class="si">{</span><span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">"%H:%M:%S"</span><span class="p">)</span><span class="si">}</span><span class="s1">'</span>
            <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">open_images</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Open the selected images in the napari viewer with napari-ndev."""</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_viewer</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_files</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">plugin</span><span class="o">=</span><span class="s1">'napari-ndev'</span><span class="p">)</span>

    <span class="c1"># Converted</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">select_next_images</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">natsort</span><span class="w"> </span><span class="kn">import</span> <span class="n">os_sorted</span>
<span class="w">        </span><span class="sd">"""Open the next set of images in the directyory."""</span>
        <span class="n">num_files</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_files</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="fm">__len__</span><span class="p">()</span>

        <span class="c1"># get the parent directory of the first file</span>
        <span class="n">first_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_files</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">parent_dir</span> <span class="o">=</span> <span class="n">first_file</span><span class="o">.</span><span class="n">parent</span>

        <span class="c1"># get the list of files in the parent directory</span>
        <span class="n">files</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">parent_dir</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="sa">f</span><span class="s1">'*</span><span class="si">{</span><span class="n">first_file</span><span class="o">.</span><span class="n">suffix</span><span class="si">}</span><span class="s1">'</span><span class="p">))</span>
        <span class="c1"># sort the files naturally (case-insensitive and numbers in order)</span>
        <span class="c1"># like would be scene in windows file explorer default sorting</span>
        <span class="c1"># https://pypi.org/project/natsort/#sort-paths-like-my-file-browser-e-g-windows-explorer-on-windows</span>

        <span class="n">files</span> <span class="o">=</span> <span class="n">os_sorted</span><span class="p">(</span><span class="n">files</span><span class="p">)</span>

        <span class="c1"># get the index of the first file in the list and then the next files</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">files</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">first_file</span><span class="p">)</span>
        <span class="n">next_files</span> <span class="o">=</span> <span class="n">files</span><span class="p">[</span><span class="n">idx</span> <span class="o">+</span> <span class="n">num_files</span> <span class="p">:</span> <span class="n">idx</span> <span class="o">+</span> <span class="n">num_files</span> <span class="o">+</span> <span class="n">num_files</span><span class="p">]</span>

        <span class="c1"># if there are no more files, then return</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">next_files</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_results</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="p">(</span>
                <span class="s1">'No more file sets to select.'</span>
            <span class="p">)</span>
            <span class="k">return</span>
        <span class="c1"># set the nwe save names, and update the file value</span>
        <span class="n">img</span> <span class="o">=</span> <span class="n">nImage</span><span class="p">(</span><span class="n">next_files</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_save_name</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">helpers</span><span class="o">.</span><span class="n">create_id_string</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">next_files</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">stem</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_files</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">next_files</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update_metadata_on_file_select</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">rescale_by</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Rescale the selected layers based on the given scale."""</span>
        <span class="n">layers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_viewer</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">selection</span>
        <span class="n">scale_tup</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_scale_tuple</span><span class="o">.</span><span class="n">value</span>

        <span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="n">layers</span><span class="p">:</span>
            <span class="n">scale_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">layer</span><span class="o">.</span><span class="n">scale</span><span class="p">)</span>
            <span class="c1"># get the scale_tup from the back of the tuple first, in case dims</span>
            <span class="c1"># are missing in the new layer</span>
            <span class="n">layer</span><span class="o">.</span><span class="n">scale</span> <span class="o">=</span> <span class="n">scale_tup</span><span class="p">[</span><span class="o">-</span><span class="n">scale_len</span><span class="p">:]</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">concatenate_files</span><span class="p">(</span>
        <span class="n">files</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Concatenate the image data from the selected files.</span>

<span class="sd">        Removes "empty" channels, which are channels with no values above 0.</span>
<span class="sd">        This is present in some microscope formats where it will image in RGB,</span>
<span class="sd">        and then leave empty channels not represented by the color channels.</span>

<span class="sd">        Does not currently handle scenes.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        files : str or Path or list of str or Path</span>
<span class="sd">            The file(s) to concatenate.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        numpy.ndarray</span>
<span class="sd">            The concatenated image data.</span>

<span class="sd">        """</span>
        <span class="n">array_list</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
            <span class="n">img</span> <span class="o">=</span> <span class="n">nImage</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>

            <span class="k">if</span> <span class="s1">'S'</span> <span class="ow">in</span> <span class="n">img</span><span class="o">.</span><span class="n">dims</span><span class="o">.</span><span class="n">order</span><span class="p">:</span>
                <span class="n">img_data</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">get_image_data</span><span class="p">(</span><span class="s1">'TSZYX'</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">img_data</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">data</span>

            <span class="c1"># iterate over all channels and only keep if not blank</span>
            <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">img_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                <span class="n">array</span> <span class="o">=</span> <span class="n">img_data</span><span class="p">[:,</span> <span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="p">:,</span> <span class="p">:,</span> <span class="p">:]</span>
                <span class="k">if</span> <span class="n">array</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">array_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">array</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">array_list</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">concatenate_layers</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">layers</span><span class="p">:</span> <span class="n">Layer</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">Layer</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Concatenate the image data from the selected layers.</span>

<span class="sd">        Adapts all layers to 5D arrays for compatibility with image dims.</span>
<span class="sd">        If the layer is a shapes layer, it will look for a corresponding image</span>
<span class="sd">        layer to get the dimensions for the shapes layer.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        layers : napari.layers.Image or list of napari.layers.Image</span>
<span class="sd">            The selected image layers.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        numpy.ndarray</span>
<span class="sd">            The concatenated image data.</span>

<span class="sd">        """</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">layer</span><span class="p">,</span> <span class="n">ShapesLayer</span><span class="p">)</span> <span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="n">layers</span><span class="p">):</span>
            <span class="n">shape_to_label_dim</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_dims_for_shape_layer</span><span class="p">()</span>

        <span class="n">array_list</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="n">layers</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">layer</span><span class="p">,</span> <span class="n">ShapesLayer</span><span class="p">):</span>
                <span class="n">layer_data</span> <span class="o">=</span> <span class="n">layer</span><span class="o">.</span><span class="n">to_labels</span><span class="p">(</span><span class="n">labels_shape</span><span class="o">=</span><span class="n">shape_to_label_dim</span><span class="p">)</span>
                <span class="n">layer_data</span> <span class="o">=</span> <span class="n">layer_data</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int16</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">layer_data</span> <span class="o">=</span> <span class="n">layer</span><span class="o">.</span><span class="n">data</span>

            <span class="n">array_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">layer_data</span><span class="p">)</span>

        <span class="c1"># stack along a new axis, which will be the channel axis for saving</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">array_list</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_dims_for_shape_layer</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]:</span>
        <span class="c1"># use dimension of the current image file</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_squeezed_dims</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_squeezed_dims</span>

        <span class="c1"># if no dims available, get it from the first instance in the viewer</span>
        <span class="n">dim_layer</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span>
                <span class="p">(</span><span class="n">layer</span> <span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_viewer</span><span class="o">.</span><span class="n">layers</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">layer</span><span class="p">,</span> <span class="p">(</span><span class="n">ImageLayer</span><span class="p">,</span> <span class="n">LabelsLayer</span><span class="p">))),</span>
                <span class="kc">None</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="n">dim_layer</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">'No image or labels present to convert shapes layer.'</span><span class="p">)</span>
        <span class="n">label_dim</span> <span class="o">=</span> <span class="n">dim_layer</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span>
            <span class="c1"># drop last axis if represents RGB image</span>
        <span class="n">label_dim</span> <span class="o">=</span> <span class="n">label_dim</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">label_dim</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span> <span class="k">else</span> <span class="n">label_dim</span>

        <span class="k">return</span> <span class="n">label_dim</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_save_loc</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">root_dir</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="n">parent</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">file_name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Path</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Get the save location based on the parent directory.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        root_dir : Path</span>
<span class="sd">            The root directory.</span>
<span class="sd">        parent : str</span>
<span class="sd">            The parent directory. eg. 'Image', 'Labels', 'ShapesAsLabels'</span>
<span class="sd">        file_name : str</span>
<span class="sd">            The file name.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Path</span>
<span class="sd">            The save location. root_dir / parent / file_name</span>

<span class="sd">        """</span>
        <span class="n">save_directory</span> <span class="o">=</span> <span class="n">root_dir</span> <span class="o">/</span> <span class="n">parent</span>
        <span class="n">save_directory</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">save_directory</span> <span class="o">/</span> <span class="n">file_name</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_common_save_logic</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="n">uri</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
        <span class="n">dim_order</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">channel_names</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
        <span class="n">image_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">result_str</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Save data as OME-TIFF with bioio based on common logic.</span>

<span class="sd">        Converts labels to np.int32 if np.int64 is detected, due to bioio</span>
<span class="sd">        not supporting np.int64 labels, even though napari and other libraries</span>
<span class="sd">        generate np.int64 labels.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        data : np.ndarray</span>
<span class="sd">            The data to save.</span>
<span class="sd">        uri : Path</span>
<span class="sd">            The URI to save the data to.</span>
<span class="sd">        dim_order : str</span>
<span class="sd">            The dimension order.</span>
<span class="sd">        channel_names : list[str]</span>
<span class="sd">            The channel names saved to OME metadata</span>
<span class="sd">        image_name : str | list[str | None] | None</span>
<span class="sd">            The image name saved to OME metadata</span>
<span class="sd">        result_str : str</span>
<span class="sd">            The string used for the result widget.</span>

<span class="sd">        """</span>
        <span class="c1"># TODO: add image_name to save method</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">bioio.writers</span><span class="w"> </span><span class="kn">import</span> <span class="n">OmeTiffWriter</span>

        <span class="c1"># BioImage does not allow saving labels as np.int64</span>
        <span class="c1"># napari generates labels differently depending on the OS</span>
        <span class="c1"># so we need to convert to np.int32 in case np.int64 generated</span>
        <span class="c1"># see: https://github.com/napari/napari/issues/5545</span>
        <span class="c1"># This is a failsafe</span>
        <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">OmeTiffWriter</span><span class="o">.</span><span class="n">save</span><span class="p">(</span>
                <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
                <span class="n">uri</span><span class="o">=</span><span class="n">uri</span><span class="p">,</span>
                <span class="n">dim_order</span><span class="o">=</span><span class="n">dim_order</span> <span class="ow">or</span> <span class="kc">None</span><span class="p">,</span>
                <span class="n">channel_names</span><span class="o">=</span><span class="n">channel_names</span> <span class="ow">or</span> <span class="kc">None</span><span class="p">,</span>
                <span class="n">image_name</span><span class="o">=</span><span class="n">image_name</span> <span class="ow">or</span> <span class="kc">None</span><span class="p">,</span>
                <span class="n">physical_pixel_sizes</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">p_sizes</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_results</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">'Saved </span><span class="si">{</span><span class="n">result_str</span><span class="si">}</span><span class="s1">: '</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_save_name</span><span class="o">.</span><span class="n">value</span>
            <span class="p">)</span> <span class="o">+</span> <span class="sa">f</span><span class="s1">'</span><span class="se">\n</span><span class="s1">At </span><span class="si">{</span><span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">"%H:%M:%S"</span><span class="p">)</span><span class="si">}</span><span class="s1">'</span>
        <span class="c1"># if ValueError is raised, save with default channel names</span>
        <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">OmeTiffWriter</span><span class="o">.</span><span class="n">save</span><span class="p">(</span>
                <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
                <span class="n">uri</span><span class="o">=</span><span class="n">uri</span><span class="p">,</span>
                <span class="n">dim_order</span><span class="o">=</span><span class="n">dim_order</span><span class="p">,</span>
                <span class="n">image_name</span><span class="o">=</span><span class="n">image_name</span> <span class="ow">or</span> <span class="kc">None</span><span class="p">,</span>
                <span class="n">physical_pixel_sizes</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">p_sizes</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_results</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="p">(</span>
                <span class="s1">'ValueError: '</span>
                <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
                <span class="o">+</span> <span class="s1">'</span><span class="se">\n</span><span class="s1">So, saved with default channel names: </span><span class="se">\n</span><span class="s1">'</span>
                <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_save_name</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
                <span class="o">+</span> <span class="sa">f</span><span class="s1">'</span><span class="se">\n</span><span class="s1">At </span><span class="si">{</span><span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">"%H:%M:%S"</span><span class="p">)</span><span class="si">}</span><span class="s1">'</span>
            <span class="p">)</span>
        <span class="k">return</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_determine_save_directory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">save_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_save_directory_prefix</span><span class="o">.</span><span class="n">value</span> <span class="o">!=</span> <span class="s1">''</span><span class="p">:</span>
            <span class="n">save_dir</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">'</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_save_directory_prefix</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">save_dir</span><span class="si">}</span><span class="s1">'</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">save_dir</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">'</span><span class="si">{</span><span class="n">save_dir</span><span class="si">}</span><span class="s1">'</span>
        <span class="k">return</span> <span class="n">save_dir</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">save_files_as_ome_tiff</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""Save the selected files as OME-TIFF using BioImage."""</span>
        <span class="n">img_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">concatenate_files</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_files</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="n">save_dir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_determine_save_directory</span><span class="p">(</span><span class="s1">'ConcatenatedImages'</span><span class="p">)</span>
        <span class="n">img_save_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">'</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_save_name</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s1">.tiff'</span>
        <span class="n">img_save_loc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_save_loc</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_save_directory</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
            <span class="n">save_dir</span><span class="p">,</span>
            <span class="n">img_save_name</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">cnames</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_channel_names</span><span class="o">.</span><span class="n">value</span>
        <span class="n">channel_names</span> <span class="o">=</span> <span class="n">ast</span><span class="o">.</span><span class="n">literal_eval</span><span class="p">(</span><span class="n">cnames</span><span class="p">)</span> <span class="k">if</span> <span class="n">cnames</span> <span class="k">else</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_common_save_logic</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="n">img_data</span><span class="p">,</span>
            <span class="n">uri</span><span class="o">=</span><span class="n">img_save_loc</span><span class="p">,</span>
            <span class="n">dim_order</span><span class="o">=</span><span class="s1">'TCZYX'</span><span class="p">,</span>
            <span class="n">channel_names</span><span class="o">=</span><span class="n">channel_names</span><span class="p">,</span>
            <span class="n">image_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_save_name</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
            <span class="n">result_str</span><span class="o">=</span><span class="s1">'Concatenated Image'</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">img_data</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">batch_concatenate_files</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Concatenate files in the selected directory.</span>

<span class="sd">        Save the concatenated files as OME-TIFF, then select the next set of</span>
<span class="sd">        files in the directory to be concatenated. This is done by iterating</span>
<span class="sd">        over the remaining files in the directory based on the number of files</span>
<span class="sd">        selected. The files are sorted alphabetically and numerically. The</span>
<span class="sd">        files will be concatenated until no more files are left in the parent</span>
<span class="sd">        directory.</span>
<span class="sd">        """</span>
        <span class="c1"># get total number of sets of files in the directory</span>
        <span class="n">parent_dir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_files</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">parent</span>
        <span class="n">total_num_files</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">parent_dir</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="sa">f</span><span class="s1">'*</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_files</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">suffix</span><span class="si">}</span><span class="s1">'</span><span class="p">)))</span>
        <span class="n">num_files</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_files</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="fm">__len__</span><span class="p">()</span>
        <span class="n">num_file_sets</span> <span class="o">=</span> <span class="n">total_num_files</span> <span class="o">//</span> <span class="n">num_files</span>

        <span class="c1"># check if channel names and scale are different than in the first file</span>
        <span class="c1"># if so, turn off the update options</span>
        <span class="n">first_image</span> <span class="o">=</span> <span class="n">nImage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_files</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">first_image</span><span class="o">.</span><span class="n">channel_names</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_channel_names</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_update_channel_names</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">first_image</span><span class="o">.</span><span class="n">physical_pixel_sizes</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_sizes</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_update_scale</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="kc">False</span>


        <span class="c1"># save first set of files</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_files_as_ome_tiff</span><span class="p">()</span>
        <span class="c1"># iterate through the remaining sets of files in the directory</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_file_sets</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">select_next_images</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">save_files_as_ome_tiff</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_results</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s1">'Batch concatenated files in directory.'</span>
            <span class="sa">f</span><span class="s1">'</span><span class="se">\n</span><span class="s1">At </span><span class="si">{</span><span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">"%H:%M:%S"</span><span class="p">)</span><span class="si">}</span><span class="s1">'</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">save_scenes_ome_tiff</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Save selected scenes as OME-TIFF.</span>

<span class="sd">        This method is intended to save scenes from a single file. The scenes</span>
<span class="sd">        are extracted based on the scenes_to_extract widget value, which is a</span>
<span class="sd">        list of scene indices. If the widget is left blank, then all scenes</span>
<span class="sd">        will be extracted.</span>

<span class="sd">        """</span>
        <span class="n">img</span> <span class="o">=</span> <span class="n">nImage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_files</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="n">scenes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_scenes_to_extract</span><span class="o">.</span><span class="n">value</span>
        <span class="n">scenes_list</span> <span class="o">=</span> <span class="n">ast</span><span class="o">.</span><span class="n">literal_eval</span><span class="p">(</span><span class="n">scenes</span><span class="p">)</span> <span class="k">if</span> <span class="n">scenes</span> <span class="k">else</span> <span class="n">img</span><span class="o">.</span><span class="n">scenes</span>
        <span class="n">save_dir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_determine_save_directory</span><span class="p">(</span><span class="s1">'ExtractedScenes'</span><span class="p">)</span>
        <span class="n">save_directory</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_save_directory</span><span class="o">.</span><span class="n">value</span> <span class="o">/</span> <span class="n">save_dir</span>
        <span class="n">save_directory</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">scene</span> <span class="ow">in</span> <span class="n">scenes_list</span><span class="p">:</span>
            <span class="c1"># TODO: fix this to not have an issue if there are identical scenes</span>
            <span class="c1"># presented as strings, though the asssumption is most times the</span>
            <span class="c1"># user will input a list of integers.</span>
            <span class="n">img</span><span class="o">.</span><span class="n">set_scene</span><span class="p">(</span><span class="n">scene</span><span class="p">)</span>

            <span class="n">base_save_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_save_name</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">'.'</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">image_id</span> <span class="o">=</span> <span class="n">helpers</span><span class="o">.</span><span class="n">create_id_string</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">base_save_name</span><span class="p">)</span>

            <span class="n">img_save_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">'</span><span class="si">{</span><span class="n">image_id</span><span class="si">}</span><span class="s1">.tiff'</span>
            <span class="n">img_save_loc</span> <span class="o">=</span> <span class="n">save_directory</span> <span class="o">/</span> <span class="n">img_save_name</span>

            <span class="c1"># get channel names from widget if truthy</span>
            <span class="n">cnames</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_channel_names</span><span class="o">.</span><span class="n">value</span>
            <span class="n">channel_names</span> <span class="o">=</span> <span class="n">ast</span><span class="o">.</span><span class="n">literal_eval</span><span class="p">(</span><span class="n">cnames</span><span class="p">)</span> <span class="k">if</span> <span class="n">cnames</span> <span class="k">else</span> <span class="kc">None</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_common_save_logic</span><span class="p">(</span>
                <span class="n">data</span><span class="o">=</span><span class="n">img</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
                <span class="n">uri</span><span class="o">=</span><span class="n">img_save_loc</span><span class="p">,</span>
                <span class="n">dim_order</span><span class="o">=</span><span class="s1">'TCZYX'</span><span class="p">,</span>
                <span class="n">channel_names</span><span class="o">=</span><span class="n">channel_names</span><span class="p">,</span>
                <span class="n">image_name</span><span class="o">=</span><span class="n">image_id</span><span class="p">,</span>
                <span class="n">result_str</span><span class="o">=</span><span class="sa">f</span><span class="s1">'Scene: </span><span class="si">{</span><span class="n">img</span><span class="o">.</span><span class="n">current_scene</span><span class="si">}</span><span class="s1">'</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_results</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s1">'Saved extracted scenes: </span><span class="si">{</span><span class="n">scenes_list</span><span class="si">}</span><span class="s1">'</span>
            <span class="sa">f</span><span class="s1">'</span><span class="se">\n</span><span class="s1">At </span><span class="si">{</span><span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">"%H:%M:%S"</span><span class="p">)</span><span class="si">}</span><span class="s1">'</span>
        <span class="p">)</span>
        <span class="k">return</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">canvas_export_figure</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""Export the current canvas figure to the save directory."""</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_viewer</span><span class="o">.</span><span class="n">dims</span><span class="o">.</span><span class="n">ndisplay</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_results</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="p">(</span>
                <span class="s1">'Exporting Figure only works in 2D mode.'</span>
                <span class="s1">'</span><span class="se">\n</span><span class="s1">Use Screenshot for 3D figures.'</span>
                <span class="sa">f</span><span class="s1">'</span><span class="se">\n</span><span class="s1">At </span><span class="si">{</span><span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">"%H:%M:%S"</span><span class="p">)</span><span class="si">}</span><span class="s1">'</span>
            <span class="p">)</span>
            <span class="k">return</span>

        <span class="n">save_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">'</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_save_name</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s1">_figure.png'</span>
        <span class="n">save_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_save_loc</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_save_directory</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
            <span class="s1">'Figures'</span><span class="p">,</span>
            <span class="n">save_name</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">scale</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_settings</span><span class="o">.</span><span class="n">CANVAS_SCALE</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_viewer</span><span class="o">.</span><span class="n">export_figure</span><span class="p">(</span>
            <span class="n">path</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">save_path</span><span class="p">),</span>
            <span class="n">scale_factor</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_results</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s1">'Exported canvas figure to Figures directory.'</span>
            <span class="sa">f</span><span class="s1">'</span><span class="se">\n</span><span class="s1">Saved as </span><span class="si">{</span><span class="n">save_name</span><span class="si">}</span><span class="s1">'</span>
            <span class="sa">f</span><span class="s1">'</span><span class="se">\n</span><span class="s1">With scale factor of </span><span class="si">{</span><span class="n">scale</span><span class="si">}</span><span class="s1">'</span>
            <span class="sa">f</span><span class="s1">'</span><span class="se">\n</span><span class="s1">At </span><span class="si">{</span><span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">"%H:%M:%S"</span><span class="p">)</span><span class="si">}</span><span class="s1">'</span>
        <span class="p">)</span>
        <span class="k">return</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">canvas_screenshot</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""Export the current canvas screenshot to the save directory."""</span>
        <span class="n">save_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">'</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_save_name</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s1">_canvas.png'</span>
        <span class="n">save_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_save_loc</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_save_directory</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
            <span class="s1">'Figures'</span><span class="p">,</span>
            <span class="n">save_name</span>
        <span class="p">)</span>

        <span class="n">scale</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_settings</span><span class="o">.</span><span class="n">CANVAS_SCALE</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_settings</span><span class="o">.</span><span class="n">OVERRIDE_CANVAS_SIZE</span><span class="p">:</span>
            <span class="n">canvas_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_settings</span><span class="o">.</span><span class="n">CANVAS_SIZE</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">canvas_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_viewer</span><span class="o">.</span><span class="n">window</span><span class="o">.</span><span class="n">_qt_viewer</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">size</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_viewer</span><span class="o">.</span><span class="n">screenshot</span><span class="p">(</span>
            <span class="n">canvas_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">size</span><span class="o">=</span><span class="n">canvas_size</span><span class="p">,</span>
            <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span>
            <span class="n">path</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">save_path</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_results</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s1">'Exported screenshot of canvas to Figures directory.'</span>
            <span class="sa">f</span><span class="s1">'</span><span class="se">\n</span><span class="s1">Saved as </span><span class="si">{</span><span class="n">save_name</span><span class="si">}</span><span class="s1">'</span>
            <span class="sa">f</span><span class="s1">'</span><span class="se">\n</span><span class="s1">With canvas dimensions of </span><span class="si">{</span><span class="n">canvas_size</span><span class="si">}</span><span class="s1">'</span>
            <span class="sa">f</span><span class="s1">'</span><span class="se">\n</span><span class="s1">With scale factor of </span><span class="si">{</span><span class="n">scale</span><span class="si">}</span><span class="s1">'</span>
            <span class="sa">f</span><span class="s1">'</span><span class="se">\n</span><span class="s1">At </span><span class="si">{</span><span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">"%H:%M:%S"</span><span class="p">)</span><span class="si">}</span><span class="s1">'</span>
        <span class="p">)</span>
        <span class="k">return</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">save_layers_as_ome_tiff</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Save the selected layers as OME-TIFF.</span>

<span class="sd">        Determines types of layers and saves to corresponding directories.</span>
<span class="sd">        """</span>
        <span class="n">layer_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">concatenate_layers</span><span class="p">(</span>
            <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_viewer</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">selection</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="c1"># get the types of layers, to know where to save the image</span>
        <span class="n">layer_types</span> <span class="o">=</span> <span class="p">[</span>
            <span class="nb">type</span><span class="p">(</span><span class="n">layer</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span> <span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_viewer</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">selection</span>
        <span class="p">]</span>

        <span class="c1"># if there are multiple layer types, save to Layers directory</span>
        <span class="n">layer_save_type</span> <span class="o">=</span> <span class="s1">'Layers'</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">layer_types</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">layer_types</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">layer_save_dir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_determine_save_directory</span><span class="p">(</span><span class="n">layer_save_type</span><span class="p">)</span>
        <span class="n">layer_save_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">'</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_save_name</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s1">.tiff'</span>
        <span class="n">layer_save_loc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_save_loc</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_save_directory</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">layer_save_dir</span><span class="p">,</span> <span class="n">layer_save_name</span>
        <span class="p">)</span>

        <span class="c1"># only get channel names if layer_save_type is not shapes or labels layer</span>
        <span class="k">if</span> <span class="n">layer_save_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">'Shapes'</span><span class="p">,</span> <span class="s1">'Labels'</span><span class="p">]:</span>
            <span class="n">cnames</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_channel_names</span><span class="o">.</span><span class="n">value</span>
            <span class="n">channel_names</span> <span class="o">=</span> <span class="n">ast</span><span class="o">.</span><span class="n">literal_eval</span><span class="p">(</span><span class="n">cnames</span><span class="p">)</span> <span class="k">if</span> <span class="n">cnames</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">channel_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">layer_save_type</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">layer_save_type</span> <span class="o">==</span> <span class="s1">'Shapes'</span><span class="p">:</span>
            <span class="n">layer_data</span> <span class="o">=</span> <span class="n">layer_data</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int16</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">layer_save_type</span> <span class="o">==</span> <span class="s1">'Labels'</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">layer_data</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">65535</span><span class="p">:</span>
                <span class="n">layer_data</span> <span class="o">=</span> <span class="n">layer_data</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">layer_data</span> <span class="o">=</span> <span class="n">layer_data</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int16</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_squeezed_dims_order</span><span class="p">:</span>
            <span class="n">dim_order</span> <span class="o">=</span> <span class="s1">'C'</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_squeezed_dims_order</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># get the dim order from 'C' + whatever other dims are left but from</span>
            <span class="c1"># right to left of layer_data.shape</span>
            <span class="n">num_dims</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">layer_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
            <span class="n">dim_order</span> <span class="o">=</span> <span class="s1">'C'</span> <span class="o">+</span> <span class="s1">''</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="s1">'TZYX'</span><span class="p">[</span><span class="o">-</span><span class="p">(</span><span class="n">num_dims</span><span class="o">-</span><span class="mi">1</span><span class="p">):]]</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_common_save_logic</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="n">layer_data</span><span class="p">,</span>
            <span class="n">uri</span><span class="o">=</span><span class="n">layer_save_loc</span><span class="p">,</span>
            <span class="n">dim_order</span><span class="o">=</span><span class="n">dim_order</span><span class="p">,</span>
            <span class="n">channel_names</span><span class="o">=</span><span class="n">channel_names</span><span class="p">,</span>
            <span class="n">image_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_save_name</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
            <span class="n">result_str</span><span class="o">=</span><span class="n">layer_save_type</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">layer_data</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="napari_ndev.widgets._utilities_container.UtilitiesContainer.p_sizes" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">p_sizes</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#napari_ndev.widgets._utilities_container.UtilitiesContainer.p_sizes" class="headerlink" title="Permanent link">#</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">p_sizes</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Get the physical pixel sizes.</p>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="PhysicalPixelSizes">PhysicalPixelSizes</span></code>
          –
          <div class="doc-md-description">
            <p>The physical pixel sizes.</p>
          </div>
        </li>
    </ul>

    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="napari_ndev.widgets._utilities_container.UtilitiesContainer.__init__" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">__init__</span>


<a href="#napari_ndev.widgets._utilities_container.UtilitiesContainer.__init__" class="headerlink" title="Permanent link">#</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="fm">__init__</span><span class="p">(</span><span class="nf">viewer</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Initialize the UtilitiesContainer widget.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<h4 id="napari_ndev.widgets._utilities_container.UtilitiesContainer.__init__(viewer)" class="doc doc-heading doc-heading-parameter">              <b><code>viewer</code></b>
<a href="#napari_ndev.widgets._utilities_container.UtilitiesContainer.__init__(viewer)" class="headerlink" title="Permanent link">#</a></h4>              (<code><a class="autorefs autorefs-external" title="napari.viewer.Viewer" href="https://napari.org/stable/api/napari.Viewer.html#napari.Viewer">Viewer</a></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>The napari viewer instance.</p>
          </div>
        </li>
    </ul>


            <details class="quote">
              <summary>Source code in <code>src/napari_ndev/widgets/_utilities_container.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">viewer</span><span class="p">:</span> <span class="n">napari</span><span class="o">.</span><span class="n">viewer</span><span class="o">.</span><span class="n">Viewer</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Initialize the UtilitiesContainer widget.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    viewer : napari.viewer.Viewer, optional</span>
<span class="sd">        The napari viewer instance.</span>

<span class="sd">    """</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">min_width</span> <span class="o">=</span> <span class="mi">500</span> <span class="c1"># TODO: remove this hardcoded value</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_viewer</span> <span class="o">=</span> <span class="n">viewer</span> <span class="k">if</span> <span class="n">viewer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_squeezed_dims_order</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_squeezed_dims</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_settings</span> <span class="o">=</span> <span class="n">get_settings</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_init_widgets</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_init_save_name_container</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_init_open_image_container</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_init_metadata_container</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_init_concatenate_files_container</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_init_save_layers_container</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_init_scene_container</span><span class="p">()</span>
    <span class="c1"># self._init_figure_options_container() # TODO: add figure saving</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_init_layout</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_connect_events</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="napari_ndev.widgets._utilities_container.UtilitiesContainer.append_scene_to_name" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">append_scene_to_name</span>


<a href="#napari_ndev.widgets._utilities_container.UtilitiesContainer.append_scene_to_name" class="headerlink" title="Permanent link">#</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">append_scene_to_name</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Append the scene to the save name.</p>


            <details class="quote">
              <summary>Source code in <code>src/napari_ndev/widgets/_utilities_container.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">append_scene_to_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Append the scene to the save name."""</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_viewer</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">selection</span><span class="o">.</span><span class="n">active</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">img</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_viewer</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">selection</span><span class="o">.</span><span class="n">active</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">'bioimage'</span><span class="p">]</span>
            <span class="c1"># remove bad characters from scene name</span>
            <span class="n">scene</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">'[^\w\s]'</span><span class="p">,</span> <span class="s1">'-'</span><span class="p">,</span> <span class="n">img</span><span class="o">.</span><span class="n">current_scene</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_save_name</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">'</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_save_name</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">scene</span><span class="si">}</span><span class="s1">'</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_results</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="p">(</span>
                <span class="s1">'Tried to append scene to name, but layer not opened with'</span>
                <span class="s1">' nDev reader.'</span>
            <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_results</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s1">'Tried to append scene to name, but no layer selected.'</span>
            <span class="s1">' So the first scene from the first file will be appended.'</span>
        <span class="p">)</span>
        <span class="n">img</span> <span class="o">=</span> <span class="n">nImage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_files</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">scene</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">'[^\w\s]'</span><span class="p">,</span> <span class="s1">'-'</span><span class="p">,</span> <span class="n">img</span><span class="o">.</span><span class="n">current_scene</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_save_name</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">'</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_save_name</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">scene</span><span class="si">}</span><span class="s1">'</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="napari_ndev.widgets._utilities_container.UtilitiesContainer.batch_concatenate_files" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">batch_concatenate_files</span>


<a href="#napari_ndev.widgets._utilities_container.UtilitiesContainer.batch_concatenate_files" class="headerlink" title="Permanent link">#</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">batch_concatenate_files</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Concatenate files in the selected directory.</p>
<p>Save the concatenated files as OME-TIFF, then select the next set of
files in the directory to be concatenated. This is done by iterating
over the remaining files in the directory based on the number of files
selected. The files are sorted alphabetically and numerically. The
files will be concatenated until no more files are left in the parent
directory.</p>


            <details class="quote">
              <summary>Source code in <code>src/napari_ndev/widgets/_utilities_container.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">batch_concatenate_files</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Concatenate files in the selected directory.</span>

<span class="sd">    Save the concatenated files as OME-TIFF, then select the next set of</span>
<span class="sd">    files in the directory to be concatenated. This is done by iterating</span>
<span class="sd">    over the remaining files in the directory based on the number of files</span>
<span class="sd">    selected. The files are sorted alphabetically and numerically. The</span>
<span class="sd">    files will be concatenated until no more files are left in the parent</span>
<span class="sd">    directory.</span>
<span class="sd">    """</span>
    <span class="c1"># get total number of sets of files in the directory</span>
    <span class="n">parent_dir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_files</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">parent</span>
    <span class="n">total_num_files</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">parent_dir</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="sa">f</span><span class="s1">'*</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_files</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">suffix</span><span class="si">}</span><span class="s1">'</span><span class="p">)))</span>
    <span class="n">num_files</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_files</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="fm">__len__</span><span class="p">()</span>
    <span class="n">num_file_sets</span> <span class="o">=</span> <span class="n">total_num_files</span> <span class="o">//</span> <span class="n">num_files</span>

    <span class="c1"># check if channel names and scale are different than in the first file</span>
    <span class="c1"># if so, turn off the update options</span>
    <span class="n">first_image</span> <span class="o">=</span> <span class="n">nImage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_files</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">first_image</span><span class="o">.</span><span class="n">channel_names</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_channel_names</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_channel_names</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="n">first_image</span><span class="o">.</span><span class="n">physical_pixel_sizes</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_sizes</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_scale</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="kc">False</span>


    <span class="c1"># save first set of files</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">save_files_as_ome_tiff</span><span class="p">()</span>
    <span class="c1"># iterate through the remaining sets of files in the directory</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_file_sets</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">select_next_images</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_files_as_ome_tiff</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_results</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s1">'Batch concatenated files in directory.'</span>
        <span class="sa">f</span><span class="s1">'</span><span class="se">\n</span><span class="s1">At </span><span class="si">{</span><span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">"%H:%M:%S"</span><span class="p">)</span><span class="si">}</span><span class="s1">'</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="napari_ndev.widgets._utilities_container.UtilitiesContainer.canvas_export_figure" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">canvas_export_figure</span>


<a href="#napari_ndev.widgets._utilities_container.UtilitiesContainer.canvas_export_figure" class="headerlink" title="Permanent link">#</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">canvas_export_figure</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Export the current canvas figure to the save directory.</p>


            <details class="quote">
              <summary>Source code in <code>src/napari_ndev/widgets/_utilities_container.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span>
<span class="normal">925</span>
<span class="normal">926</span>
<span class="normal">927</span>
<span class="normal">928</span>
<span class="normal">929</span>
<span class="normal">930</span>
<span class="normal">931</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">canvas_export_figure</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""Export the current canvas figure to the save directory."""</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_viewer</span><span class="o">.</span><span class="n">dims</span><span class="o">.</span><span class="n">ndisplay</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_results</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s1">'Exporting Figure only works in 2D mode.'</span>
            <span class="s1">'</span><span class="se">\n</span><span class="s1">Use Screenshot for 3D figures.'</span>
            <span class="sa">f</span><span class="s1">'</span><span class="se">\n</span><span class="s1">At </span><span class="si">{</span><span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">"%H:%M:%S"</span><span class="p">)</span><span class="si">}</span><span class="s1">'</span>
        <span class="p">)</span>
        <span class="k">return</span>

    <span class="n">save_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">'</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_save_name</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s1">_figure.png'</span>
    <span class="n">save_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_save_loc</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_save_directory</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
        <span class="s1">'Figures'</span><span class="p">,</span>
        <span class="n">save_name</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">scale</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_settings</span><span class="o">.</span><span class="n">CANVAS_SCALE</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_viewer</span><span class="o">.</span><span class="n">export_figure</span><span class="p">(</span>
        <span class="n">path</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">save_path</span><span class="p">),</span>
        <span class="n">scale_factor</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_results</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="p">(</span>
        <span class="sa">f</span><span class="s1">'Exported canvas figure to Figures directory.'</span>
        <span class="sa">f</span><span class="s1">'</span><span class="se">\n</span><span class="s1">Saved as </span><span class="si">{</span><span class="n">save_name</span><span class="si">}</span><span class="s1">'</span>
        <span class="sa">f</span><span class="s1">'</span><span class="se">\n</span><span class="s1">With scale factor of </span><span class="si">{</span><span class="n">scale</span><span class="si">}</span><span class="s1">'</span>
        <span class="sa">f</span><span class="s1">'</span><span class="se">\n</span><span class="s1">At </span><span class="si">{</span><span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">"%H:%M:%S"</span><span class="p">)</span><span class="si">}</span><span class="s1">'</span>
    <span class="p">)</span>
    <span class="k">return</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="napari_ndev.widgets._utilities_container.UtilitiesContainer.canvas_screenshot" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">canvas_screenshot</span>


<a href="#napari_ndev.widgets._utilities_container.UtilitiesContainer.canvas_screenshot" class="headerlink" title="Permanent link">#</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">canvas_screenshot</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Export the current canvas screenshot to the save directory.</p>


            <details class="quote">
              <summary>Source code in <code>src/napari_ndev/widgets/_utilities_container.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">933</span>
<span class="normal">934</span>
<span class="normal">935</span>
<span class="normal">936</span>
<span class="normal">937</span>
<span class="normal">938</span>
<span class="normal">939</span>
<span class="normal">940</span>
<span class="normal">941</span>
<span class="normal">942</span>
<span class="normal">943</span>
<span class="normal">944</span>
<span class="normal">945</span>
<span class="normal">946</span>
<span class="normal">947</span>
<span class="normal">948</span>
<span class="normal">949</span>
<span class="normal">950</span>
<span class="normal">951</span>
<span class="normal">952</span>
<span class="normal">953</span>
<span class="normal">954</span>
<span class="normal">955</span>
<span class="normal">956</span>
<span class="normal">957</span>
<span class="normal">958</span>
<span class="normal">959</span>
<span class="normal">960</span>
<span class="normal">961</span>
<span class="normal">962</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">canvas_screenshot</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""Export the current canvas screenshot to the save directory."""</span>
    <span class="n">save_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">'</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_save_name</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s1">_canvas.png'</span>
    <span class="n">save_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_save_loc</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_save_directory</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
        <span class="s1">'Figures'</span><span class="p">,</span>
        <span class="n">save_name</span>
    <span class="p">)</span>

    <span class="n">scale</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_settings</span><span class="o">.</span><span class="n">CANVAS_SCALE</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_settings</span><span class="o">.</span><span class="n">OVERRIDE_CANVAS_SIZE</span><span class="p">:</span>
        <span class="n">canvas_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_settings</span><span class="o">.</span><span class="n">CANVAS_SIZE</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">canvas_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_viewer</span><span class="o">.</span><span class="n">window</span><span class="o">.</span><span class="n">_qt_viewer</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">size</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_viewer</span><span class="o">.</span><span class="n">screenshot</span><span class="p">(</span>
        <span class="n">canvas_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">size</span><span class="o">=</span><span class="n">canvas_size</span><span class="p">,</span>
        <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span>
        <span class="n">path</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">save_path</span><span class="p">),</span>
    <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_results</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="p">(</span>
        <span class="sa">f</span><span class="s1">'Exported screenshot of canvas to Figures directory.'</span>
        <span class="sa">f</span><span class="s1">'</span><span class="se">\n</span><span class="s1">Saved as </span><span class="si">{</span><span class="n">save_name</span><span class="si">}</span><span class="s1">'</span>
        <span class="sa">f</span><span class="s1">'</span><span class="se">\n</span><span class="s1">With canvas dimensions of </span><span class="si">{</span><span class="n">canvas_size</span><span class="si">}</span><span class="s1">'</span>
        <span class="sa">f</span><span class="s1">'</span><span class="se">\n</span><span class="s1">With scale factor of </span><span class="si">{</span><span class="n">scale</span><span class="si">}</span><span class="s1">'</span>
        <span class="sa">f</span><span class="s1">'</span><span class="se">\n</span><span class="s1">At </span><span class="si">{</span><span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">"%H:%M:%S"</span><span class="p">)</span><span class="si">}</span><span class="s1">'</span>
    <span class="p">)</span>
    <span class="k">return</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="napari_ndev.widgets._utilities_container.UtilitiesContainer.concatenate_files" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">concatenate_files</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#napari_ndev.widgets._utilities_container.UtilitiesContainer.concatenate_files" class="headerlink" title="Permanent link">#</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">concatenate_files</span><span class="p">(</span><span class="n">files</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Concatenate the image data from the selected files.</p>
<p>Removes "empty" channels, which are channels with no values above 0.
This is present in some microscope formats where it will image in RGB,
and then leave empty channels not represented by the color channels.</p>
<p>Does not currently handle scenes.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<h4 id="napari_ndev.widgets._utilities_container.UtilitiesContainer.concatenate_files(files)" class="doc doc-heading doc-heading-parameter">              <b><code>files</code></b>
<a href="#napari_ndev.widgets._utilities_container.UtilitiesContainer.concatenate_files(files)" class="headerlink" title="Permanent link">#</a></h4>              (<code>str or Path or list of str or Path</code>)
          –
          <div class="doc-md-description">
            <p>The file(s) to concatenate.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="numpy.ndarray">ndarray</span></code>
          –
          <div class="doc-md-description">
            <p>The concatenated image data.</p>
          </div>
        </li>
    </ul>


            <details class="quote">
              <summary>Source code in <code>src/napari_ndev/widgets/_utilities_container.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">concatenate_files</span><span class="p">(</span>
    <span class="n">files</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Concatenate the image data from the selected files.</span>

<span class="sd">    Removes "empty" channels, which are channels with no values above 0.</span>
<span class="sd">    This is present in some microscope formats where it will image in RGB,</span>
<span class="sd">    and then leave empty channels not represented by the color channels.</span>

<span class="sd">    Does not currently handle scenes.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    files : str or Path or list of str or Path</span>
<span class="sd">        The file(s) to concatenate.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    numpy.ndarray</span>
<span class="sd">        The concatenated image data.</span>

<span class="sd">    """</span>
    <span class="n">array_list</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
        <span class="n">img</span> <span class="o">=</span> <span class="n">nImage</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>

        <span class="k">if</span> <span class="s1">'S'</span> <span class="ow">in</span> <span class="n">img</span><span class="o">.</span><span class="n">dims</span><span class="o">.</span><span class="n">order</span><span class="p">:</span>
            <span class="n">img_data</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">get_image_data</span><span class="p">(</span><span class="s1">'TSZYX'</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">img_data</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">data</span>

        <span class="c1"># iterate over all channels and only keep if not blank</span>
        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">img_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
            <span class="n">array</span> <span class="o">=</span> <span class="n">img_data</span><span class="p">[:,</span> <span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="p">:,</span> <span class="p">:,</span> <span class="p">:]</span>
            <span class="k">if</span> <span class="n">array</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">array_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">array</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">array_list</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="napari_ndev.widgets._utilities_container.UtilitiesContainer.concatenate_layers" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">concatenate_layers</span>


<a href="#napari_ndev.widgets._utilities_container.UtilitiesContainer.concatenate_layers" class="headerlink" title="Permanent link">#</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">concatenate_layers</span><span class="p">(</span><span class="n">layers</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Concatenate the image data from the selected layers.</p>
<p>Adapts all layers to 5D arrays for compatibility with image dims.
If the layer is a shapes layer, it will look for a corresponding image
layer to get the dimensions for the shapes layer.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<h4 id="napari_ndev.widgets._utilities_container.UtilitiesContainer.concatenate_layers(layers)" class="doc doc-heading doc-heading-parameter">              <b><code>layers</code></b>
<a href="#napari_ndev.widgets._utilities_container.UtilitiesContainer.concatenate_layers(layers)" class="headerlink" title="Permanent link">#</a></h4>              (<code>napari.layers.Image or list of napari.layers.Image</code>)
          –
          <div class="doc-md-description">
            <p>The selected image layers.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="numpy.ndarray">ndarray</span></code>
          –
          <div class="doc-md-description">
            <p>The concatenated image data.</p>
          </div>
        </li>
    </ul>


            <details class="quote">
              <summary>Source code in <code>src/napari_ndev/widgets/_utilities_container.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">concatenate_layers</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">layers</span><span class="p">:</span> <span class="n">Layer</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">Layer</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Concatenate the image data from the selected layers.</span>

<span class="sd">    Adapts all layers to 5D arrays for compatibility with image dims.</span>
<span class="sd">    If the layer is a shapes layer, it will look for a corresponding image</span>
<span class="sd">    layer to get the dimensions for the shapes layer.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    layers : napari.layers.Image or list of napari.layers.Image</span>
<span class="sd">        The selected image layers.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    numpy.ndarray</span>
<span class="sd">        The concatenated image data.</span>

<span class="sd">    """</span>
    <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">layer</span><span class="p">,</span> <span class="n">ShapesLayer</span><span class="p">)</span> <span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="n">layers</span><span class="p">):</span>
        <span class="n">shape_to_label_dim</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_dims_for_shape_layer</span><span class="p">()</span>

    <span class="n">array_list</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="n">layers</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">layer</span><span class="p">,</span> <span class="n">ShapesLayer</span><span class="p">):</span>
            <span class="n">layer_data</span> <span class="o">=</span> <span class="n">layer</span><span class="o">.</span><span class="n">to_labels</span><span class="p">(</span><span class="n">labels_shape</span><span class="o">=</span><span class="n">shape_to_label_dim</span><span class="p">)</span>
            <span class="n">layer_data</span> <span class="o">=</span> <span class="n">layer_data</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int16</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">layer_data</span> <span class="o">=</span> <span class="n">layer</span><span class="o">.</span><span class="n">data</span>

        <span class="n">array_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">layer_data</span><span class="p">)</span>

    <span class="c1"># stack along a new axis, which will be the channel axis for saving</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">array_list</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="napari_ndev.widgets._utilities_container.UtilitiesContainer.open_images" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">open_images</span>


<a href="#napari_ndev.widgets._utilities_container.UtilitiesContainer.open_images" class="headerlink" title="Permanent link">#</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">open_images</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Open the selected images in the napari viewer with napari-ndev.</p>


            <details class="quote">
              <summary>Source code in <code>src/napari_ndev/widgets/_utilities_container.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">open_images</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Open the selected images in the napari viewer with napari-ndev."""</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_viewer</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_files</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">plugin</span><span class="o">=</span><span class="s1">'napari-ndev'</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="napari_ndev.widgets._utilities_container.UtilitiesContainer.rescale_by" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">rescale_by</span>


<a href="#napari_ndev.widgets._utilities_container.UtilitiesContainer.rescale_by" class="headerlink" title="Permanent link">#</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">rescale_by</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Rescale the selected layers based on the given scale.</p>


            <details class="quote">
              <summary>Source code in <code>src/napari_ndev/widgets/_utilities_container.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">rescale_by</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Rescale the selected layers based on the given scale."""</span>
    <span class="n">layers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_viewer</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">selection</span>
    <span class="n">scale_tup</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_scale_tuple</span><span class="o">.</span><span class="n">value</span>

    <span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="n">layers</span><span class="p">:</span>
        <span class="n">scale_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">layer</span><span class="o">.</span><span class="n">scale</span><span class="p">)</span>
        <span class="c1"># get the scale_tup from the back of the tuple first, in case dims</span>
        <span class="c1"># are missing in the new layer</span>
        <span class="n">layer</span><span class="o">.</span><span class="n">scale</span> <span class="o">=</span> <span class="n">scale_tup</span><span class="p">[</span><span class="o">-</span><span class="n">scale_len</span><span class="p">:]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="napari_ndev.widgets._utilities_container.UtilitiesContainer.save_files_as_ome_tiff" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">save_files_as_ome_tiff</span>


<a href="#napari_ndev.widgets._utilities_container.UtilitiesContainer.save_files_as_ome_tiff" class="headerlink" title="Permanent link">#</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">save_files_as_ome_tiff</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Save the selected files as OME-TIFF using BioImage.</p>


            <details class="quote">
              <summary>Source code in <code>src/napari_ndev/widgets/_utilities_container.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">save_files_as_ome_tiff</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""Save the selected files as OME-TIFF using BioImage."""</span>
    <span class="n">img_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">concatenate_files</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_files</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
    <span class="n">save_dir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_determine_save_directory</span><span class="p">(</span><span class="s1">'ConcatenatedImages'</span><span class="p">)</span>
    <span class="n">img_save_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">'</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_save_name</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s1">.tiff'</span>
    <span class="n">img_save_loc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_save_loc</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_save_directory</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
        <span class="n">save_dir</span><span class="p">,</span>
        <span class="n">img_save_name</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">cnames</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_channel_names</span><span class="o">.</span><span class="n">value</span>
    <span class="n">channel_names</span> <span class="o">=</span> <span class="n">ast</span><span class="o">.</span><span class="n">literal_eval</span><span class="p">(</span><span class="n">cnames</span><span class="p">)</span> <span class="k">if</span> <span class="n">cnames</span> <span class="k">else</span> <span class="kc">None</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_common_save_logic</span><span class="p">(</span>
        <span class="n">data</span><span class="o">=</span><span class="n">img_data</span><span class="p">,</span>
        <span class="n">uri</span><span class="o">=</span><span class="n">img_save_loc</span><span class="p">,</span>
        <span class="n">dim_order</span><span class="o">=</span><span class="s1">'TCZYX'</span><span class="p">,</span>
        <span class="n">channel_names</span><span class="o">=</span><span class="n">channel_names</span><span class="p">,</span>
        <span class="n">image_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_save_name</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
        <span class="n">result_str</span><span class="o">=</span><span class="s1">'Concatenated Image'</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">img_data</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="napari_ndev.widgets._utilities_container.UtilitiesContainer.save_layers_as_ome_tiff" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">save_layers_as_ome_tiff</span>


<a href="#napari_ndev.widgets._utilities_container.UtilitiesContainer.save_layers_as_ome_tiff" class="headerlink" title="Permanent link">#</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">save_layers_as_ome_tiff</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Save the selected layers as OME-TIFF.</p>
<p>Determines types of layers and saves to corresponding directories.</p>


            <details class="quote">
              <summary>Source code in <code>src/napari_ndev/widgets/_utilities_container.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">save_layers_as_ome_tiff</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Save the selected layers as OME-TIFF.</span>

<span class="sd">    Determines types of layers and saves to corresponding directories.</span>
<span class="sd">    """</span>
    <span class="n">layer_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">concatenate_layers</span><span class="p">(</span>
        <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_viewer</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">selection</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="c1"># get the types of layers, to know where to save the image</span>
    <span class="n">layer_types</span> <span class="o">=</span> <span class="p">[</span>
        <span class="nb">type</span><span class="p">(</span><span class="n">layer</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span> <span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_viewer</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">selection</span>
    <span class="p">]</span>

    <span class="c1"># if there are multiple layer types, save to Layers directory</span>
    <span class="n">layer_save_type</span> <span class="o">=</span> <span class="s1">'Layers'</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">layer_types</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">layer_types</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">layer_save_dir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_determine_save_directory</span><span class="p">(</span><span class="n">layer_save_type</span><span class="p">)</span>
    <span class="n">layer_save_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">'</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_save_name</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s1">.tiff'</span>
    <span class="n">layer_save_loc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_save_loc</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_save_directory</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">layer_save_dir</span><span class="p">,</span> <span class="n">layer_save_name</span>
    <span class="p">)</span>

    <span class="c1"># only get channel names if layer_save_type is not shapes or labels layer</span>
    <span class="k">if</span> <span class="n">layer_save_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">'Shapes'</span><span class="p">,</span> <span class="s1">'Labels'</span><span class="p">]:</span>
        <span class="n">cnames</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_channel_names</span><span class="o">.</span><span class="n">value</span>
        <span class="n">channel_names</span> <span class="o">=</span> <span class="n">ast</span><span class="o">.</span><span class="n">literal_eval</span><span class="p">(</span><span class="n">cnames</span><span class="p">)</span> <span class="k">if</span> <span class="n">cnames</span> <span class="k">else</span> <span class="kc">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">channel_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">layer_save_type</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">layer_save_type</span> <span class="o">==</span> <span class="s1">'Shapes'</span><span class="p">:</span>
        <span class="n">layer_data</span> <span class="o">=</span> <span class="n">layer_data</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int16</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">layer_save_type</span> <span class="o">==</span> <span class="s1">'Labels'</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">layer_data</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">65535</span><span class="p">:</span>
            <span class="n">layer_data</span> <span class="o">=</span> <span class="n">layer_data</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">layer_data</span> <span class="o">=</span> <span class="n">layer_data</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int16</span><span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_squeezed_dims_order</span><span class="p">:</span>
        <span class="n">dim_order</span> <span class="o">=</span> <span class="s1">'C'</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_squeezed_dims_order</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># get the dim order from 'C' + whatever other dims are left but from</span>
        <span class="c1"># right to left of layer_data.shape</span>
        <span class="n">num_dims</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">layer_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="n">dim_order</span> <span class="o">=</span> <span class="s1">'C'</span> <span class="o">+</span> <span class="s1">''</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="s1">'TZYX'</span><span class="p">[</span><span class="o">-</span><span class="p">(</span><span class="n">num_dims</span><span class="o">-</span><span class="mi">1</span><span class="p">):]]</span>
        <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_common_save_logic</span><span class="p">(</span>
        <span class="n">data</span><span class="o">=</span><span class="n">layer_data</span><span class="p">,</span>
        <span class="n">uri</span><span class="o">=</span><span class="n">layer_save_loc</span><span class="p">,</span>
        <span class="n">dim_order</span><span class="o">=</span><span class="n">dim_order</span><span class="p">,</span>
        <span class="n">channel_names</span><span class="o">=</span><span class="n">channel_names</span><span class="p">,</span>
        <span class="n">image_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_save_name</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
        <span class="n">result_str</span><span class="o">=</span><span class="n">layer_save_type</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">layer_data</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="napari_ndev.widgets._utilities_container.UtilitiesContainer.save_scenes_ome_tiff" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">save_scenes_ome_tiff</span>


<a href="#napari_ndev.widgets._utilities_container.UtilitiesContainer.save_scenes_ome_tiff" class="headerlink" title="Permanent link">#</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">save_scenes_ome_tiff</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Save selected scenes as OME-TIFF.</p>
<p>This method is intended to save scenes from a single file. The scenes
are extracted based on the scenes_to_extract widget value, which is a
list of scene indices. If the widget is left blank, then all scenes
will be extracted.</p>


            <details class="quote">
              <summary>Source code in <code>src/napari_ndev/widgets/_utilities_container.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">save_scenes_ome_tiff</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Save selected scenes as OME-TIFF.</span>

<span class="sd">    This method is intended to save scenes from a single file. The scenes</span>
<span class="sd">    are extracted based on the scenes_to_extract widget value, which is a</span>
<span class="sd">    list of scene indices. If the widget is left blank, then all scenes</span>
<span class="sd">    will be extracted.</span>

<span class="sd">    """</span>
    <span class="n">img</span> <span class="o">=</span> <span class="n">nImage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_files</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="n">scenes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_scenes_to_extract</span><span class="o">.</span><span class="n">value</span>
    <span class="n">scenes_list</span> <span class="o">=</span> <span class="n">ast</span><span class="o">.</span><span class="n">literal_eval</span><span class="p">(</span><span class="n">scenes</span><span class="p">)</span> <span class="k">if</span> <span class="n">scenes</span> <span class="k">else</span> <span class="n">img</span><span class="o">.</span><span class="n">scenes</span>
    <span class="n">save_dir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_determine_save_directory</span><span class="p">(</span><span class="s1">'ExtractedScenes'</span><span class="p">)</span>
    <span class="n">save_directory</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_save_directory</span><span class="o">.</span><span class="n">value</span> <span class="o">/</span> <span class="n">save_dir</span>
    <span class="n">save_directory</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">scene</span> <span class="ow">in</span> <span class="n">scenes_list</span><span class="p">:</span>
        <span class="c1"># TODO: fix this to not have an issue if there are identical scenes</span>
        <span class="c1"># presented as strings, though the asssumption is most times the</span>
        <span class="c1"># user will input a list of integers.</span>
        <span class="n">img</span><span class="o">.</span><span class="n">set_scene</span><span class="p">(</span><span class="n">scene</span><span class="p">)</span>

        <span class="n">base_save_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_save_name</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">'.'</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">image_id</span> <span class="o">=</span> <span class="n">helpers</span><span class="o">.</span><span class="n">create_id_string</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">base_save_name</span><span class="p">)</span>

        <span class="n">img_save_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">'</span><span class="si">{</span><span class="n">image_id</span><span class="si">}</span><span class="s1">.tiff'</span>
        <span class="n">img_save_loc</span> <span class="o">=</span> <span class="n">save_directory</span> <span class="o">/</span> <span class="n">img_save_name</span>

        <span class="c1"># get channel names from widget if truthy</span>
        <span class="n">cnames</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_channel_names</span><span class="o">.</span><span class="n">value</span>
        <span class="n">channel_names</span> <span class="o">=</span> <span class="n">ast</span><span class="o">.</span><span class="n">literal_eval</span><span class="p">(</span><span class="n">cnames</span><span class="p">)</span> <span class="k">if</span> <span class="n">cnames</span> <span class="k">else</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_common_save_logic</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="n">img</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
            <span class="n">uri</span><span class="o">=</span><span class="n">img_save_loc</span><span class="p">,</span>
            <span class="n">dim_order</span><span class="o">=</span><span class="s1">'TCZYX'</span><span class="p">,</span>
            <span class="n">channel_names</span><span class="o">=</span><span class="n">channel_names</span><span class="p">,</span>
            <span class="n">image_name</span><span class="o">=</span><span class="n">image_id</span><span class="p">,</span>
            <span class="n">result_str</span><span class="o">=</span><span class="sa">f</span><span class="s1">'Scene: </span><span class="si">{</span><span class="n">img</span><span class="o">.</span><span class="n">current_scene</span><span class="si">}</span><span class="s1">'</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_results</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="p">(</span>
        <span class="sa">f</span><span class="s1">'Saved extracted scenes: </span><span class="si">{</span><span class="n">scenes_list</span><span class="si">}</span><span class="s1">'</span>
        <span class="sa">f</span><span class="s1">'</span><span class="se">\n</span><span class="s1">At </span><span class="si">{</span><span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">"%H:%M:%S"</span><span class="p">)</span><span class="si">}</span><span class="s1">'</span>
    <span class="p">)</span>
    <span class="k">return</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="napari_ndev.widgets._utilities_container.UtilitiesContainer.update_metadata_from_layer" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">update_metadata_from_layer</span>


<a href="#napari_ndev.widgets._utilities_container.UtilitiesContainer.update_metadata_from_layer" class="headerlink" title="Permanent link">#</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">update_metadata_from_layer</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Update metadata from the selected layer.</p>
<p>Expects images to be opened with napari-ndev reader.</p>


<details class="note:" open>
  <summary>Note:</summary>
  <p>This should also support napari-bioio in the future, when released.</p>
</details>

            <details class="quote">
              <summary>Source code in <code>src/napari_ndev/widgets/_utilities_container.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">update_metadata_from_layer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Update metadata from the selected layer.</span>

<span class="sd">    Expects images to be opened with napari-ndev reader.</span>

<span class="sd">    Note:</span>
<span class="sd">    ----</span>
<span class="sd">    This should also support napari-bioio in the future, when released.</span>

<span class="sd">    """</span>
    <span class="n">selected_layer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_viewer</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">selection</span><span class="o">.</span><span class="n">active</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">img</span> <span class="o">=</span> <span class="n">selected_layer</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">'bioimage'</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_metadata_from_Image</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>

    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_results</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s1">'Tried to update metadata, but no layer selected.'</span>
            <span class="sa">f</span><span class="s1">'</span><span class="se">\n</span><span class="s1">At </span><span class="si">{</span><span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">"%H:%M:%S"</span><span class="p">)</span><span class="si">}</span><span class="s1">'</span>
        <span class="p">)</span>
    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
        <span class="n">scale</span> <span class="o">=</span> <span class="n">selected_layer</span><span class="o">.</span><span class="n">scale</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_scale_tuple</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">scale</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">scale</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">3</span> <span class="k">else</span> <span class="mi">1</span><span class="p">,</span>
            <span class="n">scale</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span>
            <span class="n">scale</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_results</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s1">'Tried to update metadata, but could only update scale'</span>
            <span class="s1">' because layer not opened with nDev reader.'</span>
            <span class="sa">f</span><span class="s1">'</span><span class="se">\n</span><span class="s1">At </span><span class="si">{</span><span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">"%H:%M:%S"</span><span class="p">)</span><span class="si">}</span><span class="s1">'</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="napari_ndev.widgets._utilities_container.UtilitiesContainer.update_metadata_on_file_select" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">update_metadata_on_file_select</span>


<a href="#napari_ndev.widgets._utilities_container.UtilitiesContainer.update_metadata_on_file_select" class="headerlink" title="Permanent link">#</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">update_metadata_on_file_select</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Update self._save_name.value and metadata if selected.</p>


            <details class="quote">
              <summary>Source code in <code>src/napari_ndev/widgets/_utilities_container.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">update_metadata_on_file_select</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Update self._save_name.value and metadata if selected."""</span>
    <span class="c1"># TODO: get true stem of file, in case .ome.tiff</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_save_name</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_files</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">stem</span><span class="p">)</span>
    <span class="n">img</span> <span class="o">=</span> <span class="n">nImage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_files</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_update_metadata_from_Image</span><span class="p">(</span>
        <span class="n">img</span><span class="p">,</span>
        <span class="n">update_channel_names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_update_channel_names</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
        <span class="n">update_scale</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_update_scale</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="napari_ndev.widgets._utilities_container.UtilitiesContainer.update_save_directory" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">update_save_directory</span>


<a href="#napari_ndev.widgets._utilities_container.UtilitiesContainer.update_save_directory" class="headerlink" title="Permanent link">#</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">update_save_directory</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Update the save directory based on the selected files.</p>


            <details class="quote">
              <summary>Source code in <code>src/napari_ndev/widgets/_utilities_container.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">update_save_directory</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Update the save directory based on the selected files."""</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_save_directory</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_default_save_directory</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_save_directory</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_files</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2023-2025 Tim Monko
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
    <a href="https://github.com/timmonko/napari-ndev" target="_blank" rel="noopener" title="napari-ndev on GitHub" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
    <a href="https://pypi.org/project/napari-ndev" target="_blank" rel="noopener" title="napari-ndev on PyPI" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6M286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3M167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4m-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": ["content.code.annotate", "navigation.sections", "navigation.indexes", "toc.follow", "search.suggest", "search.share"], "search": "../../../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.c8b220af.min.js"></script>
      
    
  </body>
</html>